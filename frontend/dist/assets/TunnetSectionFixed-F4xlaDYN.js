import{j as e}from"./index-DsBGyFQG.js";import{r as d}from"./router-DUq0sin2.js";import k from"./api-Bqs0zQX7.js";import{X as L,v as ge,F as ae,w as he,P as be,s as fe,x as q,y as se,z as ye,A as je}from"./icons-B5_qnxFz.js";import"./Dashboard-CWmwHOAq.js";/* empty css                            */import"./vendor-Bzgz95E1.js";import"./utils-B9HHbEsj.js";import"./charts-DdKZH6bc.js";const Ne=({tenantId:b,tenantName:B,onClose:$})=>{const[j,J]=d.useState([]),[X,I]=d.useState(!1),[n,x]=d.useState(!1),[D,f]=d.useState(""),[p,N]=d.useState(null),[y,E]=d.useState("General"),[v,C]=d.useState(null),[S,h]=d.useState(""),z=["General","ID Document","Passport","Lease Agreement","Proof of Income","Bank Statement","Reference Letter","Other"];d.useEffect(()=>{w()},[b]);const w=async()=>{try{I(!0);const a=await k.getTenantDocuments(b);J(a.data?.data?.documents||[])}catch(a){console.error("Error fetching documents:",a),f(a.userMessage||"Failed to fetch documents")}finally{I(!1)}},G=a=>{const c=a.target.files;c&&c.length>0&&N(c)},T=async()=>{if(!p||p.length===0){f("Please select at least one document");return}x(!0),f("");try{const a=new FormData;for(let P=0;P<p.length;P++)a.append("documents",p[P]);a.append("document_type",y),await k.uploadTenantDocuments(b,a),N(null),E("General"),await w();const c=document.getElementById("document-upload");c&&(c.value="")}catch(a){console.error("Error uploading documents:",a),f(a.userMessage||"Failed to upload documents")}finally{x(!1)}},O=async a=>{if(confirm("Are you sure you want to delete this document?"))try{await k.deleteTenantDocument(b,a),await w()}catch(c){console.error("Error deleting document:",c),f(c.userMessage||"Failed to delete document")}},_=a=>{C(a.id),h(a.document_type)},o=async a=>{try{await k.updateTenantDocumentType(b,a,S),C(null),h(""),await w()}catch(c){console.error("Error updating document type:",c),f(c.userMessage||"Failed to update document type")}},u=()=>{C(null),h("")},A=()=>{N(null);const a=document.getElementById("document-upload");a&&(a.value="")},M=a=>a<1024?a+" B":a<1024*1024?(a/1024).toFixed(1)+" KB":(a/(1024*1024)).toFixed(1)+" MB",F=a=>a.startsWith("image/")?"üñºÔ∏è":a==="application/pdf"?"üìÑ":a.includes("word")?"üìù":a.includes("excel")||a.includes("spreadsheet")?"üìä":"üìé";return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white z-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Tenant Documents"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:B})]}),e.jsx("button",{onClick:$,className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Close",children:e.jsx(L,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Upload New Documents"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsxs("label",{htmlFor:"document-upload",className:"flex items-center justify-center w-full px-4 py-3 border border-gray-300 rounded-lg cursor-pointer bg-white hover:bg-gray-100 transition-colors",children:[e.jsx(ge,{className:"w-5 h-5 mr-2 text-gray-600"}),e.jsx("span",{className:"text-gray-700",children:"Choose Files"}),e.jsx("input",{id:"document-upload",type:"file",multiple:!0,onChange:G,className:"hidden",accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx,.txt"})]})}),e.jsx("div",{children:e.jsx("select",{value:y,onChange:a=>E(a.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:z.map(a=>e.jsx("option",{value:a,children:a},a))})})]}),p&&p.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[p.length," file(s) selected"]}),e.jsx("button",{onClick:A,className:"text-sm text-red-600 hover:text-red-800",children:"Clear Selection"})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-3 max-h-32 overflow-y-auto",children:Array.from(p).map((a,c)=>e.jsxs("div",{className:"flex items-center justify-between py-1 text-sm",children:[e.jsx("span",{className:"text-gray-700 truncate flex-1",children:a.name}),e.jsx("span",{className:"text-gray-500 ml-2",children:M(a.size)})]},c))}),e.jsx("button",{onClick:T,disabled:n,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:n?"Uploading...":"Upload Documents"})]})]})]}),D&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:D}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Uploaded Documents (",j.length,")"]}),X?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading documents..."})]}):j.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(ae,{className:"w-12 h-12 mx-auto text-gray-400 mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No documents uploaded yet"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Upload your first document above"})]}):e.jsx("div",{className:"space-y-3",children:j.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg bg-white hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[e.jsx("div",{className:"text-3xl mr-3",children:F(a.mime_type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",title:a.original_filename,children:a.original_filename}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[v===a.id?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("select",{value:S,onChange:c=>h(c.target.value),className:"text-xs px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",children:z.map(c=>e.jsx("option",{value:c,children:c},c))}),e.jsx("button",{onClick:()=>o(a.id),className:"text-green-600 hover:text-green-800",title:"Save",children:e.jsx(he,{className:"w-4 h-4"})}),e.jsx("button",{onClick:u,className:"text-gray-600 hover:text-gray-800",title:"Cancel",children:e.jsx(L,{className:"w-4 h-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:a.document_type}),e.jsx("button",{onClick:()=>_(a),className:"text-gray-400 hover:text-gray-600",title:"Edit type",children:e.jsx(be,{className:"w-3 h-3"})})]}),e.jsx("span",{className:"text-xs text-gray-500",children:M(a.file_size)})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("a",{href:a.file_url,target:"_blank",rel:"noopener noreferrer",download:!0,className:"flex items-center justify-center px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded hover:bg-blue-100 transition-colors",title:"Download",children:e.jsx(fe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>O(a.id),className:"flex items-center justify-center px-3 py-2 text-sm bg-red-50 text-red-700 rounded hover:bg-red-100 transition-colors",title:"Delete",children:e.jsx(q,{className:"w-4 h-4"})})]})]},a.id))})]})]}),e.jsx("div",{className:"flex items-center justify-end p-6 border-t border-gray-200 bg-gray-50",children:e.jsx("button",{onClick:$,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Close"})})]})})},Y=k,Ae=()=>{const b=t=>{if(!t)return"active";const s=t.toUpperCase();return s==="ACTIVE"?"active":s==="INACTIVE"?"inactive":s==="EXPIRED"?"expired":"active"},B=t=>{const s=b(t);return s==="active"?"Actif":s==="inactive"?"Inactif":s==="expired"?"Expir√©":"N/A"},$=t=>{const s=b(t);return s==="active"?"bg-green-100 text-green-800":s==="inactive"?"bg-yellow-100 text-yellow-800":s==="expired"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"},[j,J]=d.useState(""),[X,I]=d.useState(!1),[n,x]=d.useState({fullName:"",email:"",phone:"",address:"",propertyId:"",checkInDate:"",checkOutDate:"",documents:[],rent:"",charges:"",status:"ACTIVE"}),[D,f]=d.useState([]),[p,N]=d.useState([]),[y,E]=d.useState(!1),[v,C]=d.useState(null),[S,h]=d.useState(!1),[z,w]=d.useState(null),[G,T]=d.useState(!1),[O,_]=d.useState(null),[o,u]=d.useState({fullName:"",email:"",phone:"",address:"",propertyId:"",checkInDate:"",checkOutDate:"",documents:[],rent:"",charges:"",status:"ACTIVE"}),[A,M]=d.useState(null),[F,a]=d.useState({isOpen:!1,tenantId:null,tenantName:""}),[c,P]=d.useState(!1),[R,ve]=d.useState(new Set),re=async()=>{E(!0),C(null);try{if(!localStorage.getItem("token")){console.log("No token found, skipping properties API call"),N([]),E(!1);return}const s=await k.listProperties();if(console.log("üìä Properties API response:",s.data),s.data?.success&&s.data?.data?.properties){const i=s.data.data.properties.map(r=>({id:r.id,title:r.title,monthly_rent:r.monthly_rent||0}));N(i)}else C("Failed to load properties"),N([]),console.log("‚ùå Failed to load properties - invalid response structure")}catch(t){console.error("‚ùå Error fetching properties:",t),C(t.response?.data?.error||"Failed to load properties"),N([])}finally{E(!1)}},U=async(t=!0,s="unknown")=>{if(t&&R.size>0){console.log(`‚è∏Ô∏è Skipping fetchTenants (reason: ${s}) - status update in progress for:`,Array.from(R));return}console.log(`üîÑ fetchTenants called (reason: ${s}), isUpdatingStatus.size: ${R.size}`),h(!0),w(null);try{if(!localStorage.getItem("token")){console.log("No token found, skipping tenants API call"),f([]),h(!1);return}const r=JSON.parse(localStorage.getItem("user")||"{}");console.log("üë§ Current user:",r),console.log("üÜî User admin_id:",r.id),console.log("üë§ User role:",r.role);const m=await k.listTenants();console.log("üìä Tenant API response:",m.data),console.log("üìä Response success:",m.data?.success),console.log("üìä Response data structure:",m.data?.data),console.log("üìä Tenants array:",m.data?.data?.tenants),console.log("üìä Tenants count:",m.data?.data?.tenants?.length);const g=m.data?.data?.tenants||[];console.log("üìã Raw tenant data:",g),console.log("üìã Raw tenant data length:",g.length),console.log("üìã Raw tenant statuses:",g.map(l=>({id:l.id,name:l.name,status:l.status}))),console.log("üìã Raw tenant phones:",g.map(l=>({id:l.id,name:l.name,phone:l.phone,phone_number:l.phone_number})));const K={};g.forEach(l=>{const V=l.status?.toUpperCase()||"ACTIVE";l.property_id&&V==="ACTIVE"&&(K[l.property_id]=(K[l.property_id]||0)+1)});const ee=g.map(l=>{const V=l.property,te=p.find(xe=>xe.id===l.property_id),me=V?.title||V?.name||te?.title||(l.property_id?`Propri√©t√© #${l.property_id}`:"Aucune propri√©t√©"),W=V?.monthly_rent||V?.rent||te?.monthly_rent||0,H=K[l.property_id]||1,ue=H>0?W/H:W,Q=l.status?.toUpperCase()||"ACTIVE",pe=Q==="ACTIVE"?"active":Q==="INACTIVE"?"inactive":Q==="EXPIRED"?"expired":"active";return{id:String(l.id),fullName:l.name,email:l.email||"",phone:l.phone||l.phone_number||l.phoneNumber||"",propertyName:me,propertyId:l.property_id?String(l.property_id):"",checkInDate:l.lease_start||"",checkOutDate:l.lease_end||"",stayDuration:0,status:pe,avatar:"",documents:[],rent_amount:l.rent_amount||null,charges_amount:l.charges_amount||null,property_monthly_rent:W,tenants_count:H,divided_rent:ue,document_path:l.documents}});console.log(`‚úÖ Setting tenants state (reason: ${s}), mapped statuses:`,ee.map(l=>({id:l.id,name:l.fullName,status:l.status}))),f(ee)}catch(i){console.error("‚ùå Error loading tenants:",i),w(i.response?.data?.error||i.message||"Failed to load tenants"),f([])}finally{h(!1)}};d.useEffect(()=>{(async()=>{await re(),await U(!0,"component-mount")})()},[]),d.useEffect(()=>(p.length>0&&D.length===0&&R.size===0&&U(!0,"properties-changed"),()=>{h(!1),w(null)}),[p,R.size]);const le=async t=>{if(t.preventDefault(),console.log("üìù Tenant form submitted"),!n.fullName.trim()){console.log("‚ùå Validation failed: Name is required"),alert("Please enter tenant name");return}if(!n.email.trim()){console.log("‚ùå Validation failed: Email is required"),alert("Please enter tenant email");return}if(!n.propertyId){console.log("‚ùå Validation failed: Property is required"),alert("Please select a property");return}const s=parseInt(n.propertyId);if(isNaN(s)){console.log("‚ùå Validation failed: Invalid property ID"),alert("Invalid property selected");return}const i={name:n.fullName.trim(),email:n.email.trim(),property_id:s};i.status=n.status&&n.status.trim()||"ACTIVE",n.phone?.trim()&&(i.phone=n.phone.trim()),n.address?.trim()&&(i.address=n.address.trim()),n.rent&&(i.rent_amount=parseFloat(n.rent)),n.charges&&(i.charges_amount=parseFloat(n.charges)),n.checkInDate&&(i.lease_start=n.checkInDate),n.checkOutDate&&(i.lease_end=n.checkOutDate),i.status&&(i.status=i.status.toUpperCase().trim()),console.log("üì§ Sending tenant data:",JSON.stringify(i,null,2));try{h(!0);const r=await Y.createTenant(i);if(console.log("‚úÖ Tenant created successfully:",r.data),!r?.data?.success)throw new Error(r?.data?.error||"Failed to create tenant");I(!1),x({fullName:"",email:"",phone:"",address:"",propertyId:"",checkInDate:"",checkOutDate:"",documents:[],rent:"",charges:"",status:"ACTIVE"}),alert("Locataire ajout√© avec succ√®s !"),console.log("üîÑ Refreshing tenant list after creation..."),await U(!0,"after-tenant-creation")}catch(r){console.error("‚ùå Create tenant error:",r),console.error("‚ùå Error details:",{message:r?.message,response:r?.response?.data,status:r?.response?.status,statusText:r?.response?.statusText});let m="√âchec de l'ajout du locataire. Veuillez r√©essayer.";r?.response?.data?.error?m=r.response.data.error:r?.response?.data?.message?m=r.response.data.message:r?.message&&(m=r.message),r?.response?.status===400?m="Donn√©es invalides. Veuillez v√©rifier les informations saisies.":r?.response?.status===403?m="Acc√®s refus√©. Vous ne pouvez ajouter des locataires qu'√† vos propres propri√©t√©s.":r?.response?.status===404?m="Propri√©t√© non trouv√©e. Veuillez s√©lectionner une propri√©t√© valide.":r?.response?.status===500?m="Erreur serveur. Veuillez r√©essayer plus tard.":(r?.code==="NETWORK_ERROR"||r?.message?.includes("Network"))&&(m="Erreur de connexion. V√©rifiez votre connexion internet."),(m.includes("Too many requests")||r?.response?.status===429)&&(m="Trop de requ√™tes. Veuillez attendre un moment avant de r√©essayer.");const g=r?.response?.data?.details;g?(console.error("üìã Validation details:",g),alert(`${m}

D√©tails: ${JSON.stringify(g,null,2)}`)):alert(m)}finally{h(!1)}},ne=t=>{console.log("‚úèÔ∏è Editing tenant:",t),_(t),u({fullName:t.fullName||"",email:t.email||"",phone:t.phone||"",address:t.address||"",propertyId:t.propertyId||"",checkInDate:t.checkInDate||"",checkOutDate:t.checkOutDate||"",documents:[],rent:t.rent_amount?String(t.rent_amount):"",charges:t.charges_amount?String(t.charges_amount):"",status:t.status?.toUpperCase()||"ACTIVE"}),T(!0)},oe=t=>{a({isOpen:!0,tenantId:String(t.id),tenantName:t.fullName||t.name||"this tenant"})},ie=async()=>{if(F.tenantId){P(!0);try{await Y.deleteTenantApi(F.tenantId),console.log("‚úÖ Tenant deleted successfully"),a({isOpen:!1,tenantId:null,tenantName:""}),await U(!0,"after-tenant-deletion")}catch(t){console.error("‚ùå Error deleting tenant:",t);let s=t?.response?.data?.error||t?.message||"Failed to delete tenant. Please try again.";s.includes("Too many requests")&&(s="Rate limit exceeded. Please wait a moment before trying again."),alert(s)}finally{P(!1)}}},de=()=>{a({isOpen:!1,tenantId:null,tenantName:""})},ce=async t=>{if(t.preventDefault(),!O)return;if(console.log("üìù Edit tenant form submitted"),!o.fullName.trim()){alert("Please enter tenant name");return}if(!o.email.trim()){alert("Please enter tenant email");return}if(!o.propertyId){alert("Please select a property");return}const s=parseInt(o.propertyId);if(isNaN(s)){alert("Invalid property selected");return}const i={name:o.fullName.trim(),email:o.email.trim(),property_id:s};o.phone?.trim()&&(i.phone=o.phone.trim()),o.address?.trim()&&(i.address=o.address.trim()),o.rent&&(i.rent_amount=parseFloat(o.rent)),o.charges&&(i.charges_amount=parseFloat(o.charges)),o.status&&(i.status=o.status),console.log("üì§ Updating tenant data:",i);try{const r=await Y.updateTenant(O.id,i);console.log("‚úÖ Tenant updated successfully:",r.data),T(!1),_(null),u({fullName:"",email:"",phone:"",address:"",propertyId:"",checkInDate:"",checkOutDate:"",documents:[],rent:"",charges:"",status:"ACTIVE"}),console.log("üîÑ Refreshing tenant list after update..."),await U(!0,"after-tenant-edit")}catch(r){console.error("‚ùå Update tenant error:",r);let m=r?.response?.data?.error||r?.message||"Failed to update tenant. Please try again.";m.includes("Too many requests")&&(m="Rate limit exceeded. Please wait a moment before trying again.");const g=r?.response?.data?.details;g?(console.error("üìã Validation details:",g),alert(`${m}

Details: ${JSON.stringify(g,null,2)}`)):alert(m)}},Z=D.filter(t=>t.fullName?.toLowerCase().includes(j.toLowerCase())||t.propertyName?.toLowerCase().includes(j.toLowerCase())||t.propertyId?.toLowerCase().includes(j.toLowerCase()));return e.jsx("div",{className:"p-4 sm:p-6 lg:p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-6 md:mb-8 fade-in-soft text-center md:text-left",children:"Tenant Management"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 mb-6 md:mb-8 items-stretch",children:[e.jsxs("div",{className:"p-3 bg-blue-50 rounded smooth-transition hover-lift fade-in",style:{animationDelay:"0.1s"},children:[e.jsx("h3",{className:"font-semibold",children:"Properties Status:"}),y?e.jsx("p",{className:"shimmer",children:"Loading properties..."}):v?e.jsxs("p",{className:"text-red-600",children:["Error: ",v]}):e.jsxs("p",{className:"text-green-600",children:["‚úì Found ",p.length," properties"]})]}),e.jsxs("div",{className:"p-3 bg-green-50 rounded smooth-transition hover-lift fade-in",style:{animationDelay:"0.2s"},children:[e.jsx("h3",{className:"font-semibold",children:"Tenants Status:"}),S?e.jsx("p",{className:"shimmer",children:"Loading tenants..."}):z?e.jsxs("p",{className:"text-red-600",children:["Error: ",z]}):e.jsxs("p",{className:"text-green-600",children:["‚úì Found ",D.length," tenants"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-3 md:gap-4 mb-5 md:mb-7",children:[e.jsx("div",{className:"flex-1 w-full sm:max-w-md slide-in-left",children:e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 smooth-transition"}),e.jsx("input",{type:"text",placeholder:"Rechercher des locataires...",value:j,onChange:t=>J(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 smooth-transition hover-lift text-sm md:text-base"})]})}),e.jsxs("button",{onClick:()=>I(!0),className:"flex items-center justify-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 smooth-transition hover-lift-strong glow-effect slide-in-right w-full sm:w-auto",children:[e.jsx(ye,{className:"w-4 h-4 smooth-transition"}),e.jsx("span",{className:"text-sm md:text-base",children:"Ajouter un locataire"})]})]}),e.jsx("div",{className:"w-full grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 md:gap-6 items-stretch",children:Z.map((t,s)=>e.jsx("div",{className:"w-full bg-white rounded-2xl shadow-md border border-gray-100 overflow-hidden smooth-transition hover-lift fade-in min-h-[260px] sm:min-h-[280px] md:min-h-[320px] lg:min-h-[340px] flex flex-col",style:{animationDelay:`${s*.1}s`},children:e.jsxs("div",{className:"p-4 md:p-5 lg:p-6 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3 md:mb-4",children:[e.jsx("div",{className:"w-11 h-11 md:w-12 md:h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-semibold text-lg",children:t.fullName?.charAt(0)||"T"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm md:text-base",children:t.fullName}),e.jsx("p",{className:"text-xs md:text-sm text-gray-500 break-all",children:t.email})]})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 mt-1 flex-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Propri√©t√©:"})," ",t.propertyName||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"T√©l√©phone:"})," ",t.phone&&t.phone.trim()?t.phone:"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Loyer:"}),t.rent_amount!==void 0&&t.rent_amount!==null&&Number(t.rent_amount)>0?e.jsxs("span",{className:"font-semibold text-blue-600",children:["‚Ç¨",Number(t.rent_amount).toFixed(2)]}):t.divided_rent!==void 0&&t.divided_rent!==null&&Number(t.divided_rent)>0?e.jsxs("span",{children:[e.jsxs("span",{className:"font-semibold text-blue-600",children:["‚Ç¨",Number(t.divided_rent).toFixed(2)]}),t.tenants_count&&t.tenants_count>1&&e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(partag√© sur ",t.tenants_count," locataires)"]})]}):e.jsx("span",{className:"text-gray-400",children:"N/A"})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Charges:"}),t.charges_amount!==void 0&&t.charges_amount!==null&&Number(t.charges_amount)>0?e.jsxs("span",{className:"font-semibold text-green-600",children:["‚Ç¨",Number(t.charges_amount).toFixed(2)]}):e.jsx("span",{className:"text-gray-400",children:"N/A"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Statut:"}),e.jsx("span",{className:`ml-1 px-2 py-1 rounded-full text-xs ${$(t.status)}`,children:B(t.status)},`status-badge-${t.id}-${b(t.status)}`)]})})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 flex justify-end space-x-1.5 md:space-x-2",children:[e.jsx("button",{onClick:()=>M(t),className:"p-2 md:p-2.5 text-green-600 bg-green-50 hover:bg-green-100 rounded-lg nav-transition nav-hover-scale border border-green-100",title:"G√©rer les documents",children:e.jsx(ae,{className:"w-4 h-4 md:w-5 md:h-5"})}),e.jsx("button",{onClick:()=>ne(t),className:"p-2 md:p-2.5 text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg nav-transition nav-hover-scale border border-blue-100",title:"Modifier le locataire",children:e.jsx(je,{className:"w-4 h-4 md:w-5 md:h-5"})}),e.jsx("button",{onClick:()=>oe(t),className:"p-2 md:p-2.5 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg nav-transition nav-hover-scale hover:text-red-700 border border-red-100",title:"Supprimer le locataire",children:e.jsx(q,{className:"w-4 h-4 md:w-5 md:h-5"})})]})]})},`tenant-${t.id}-${b(t.status)}-${s}`))}),Z.length===0&&!S&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-2",children:e.jsx(se,{className:"w-12 h-12 mx-auto"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"Aucun locataire trouv√©"}),e.jsx("p",{className:"text-gray-600",children:"Essayez d'ajuster vos termes de recherche ou ajoutez un nouveau locataire."})]}),S&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-blue-400 mb-2",children:e.jsx("div",{className:"w-12 h-12 mx-auto border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"Chargement des locataires..."}),e.jsx("p",{className:"text-gray-600",children:"Veuillez patienter pendant que nous r√©cup√©rons les donn√©es des locataires."})]}),X&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-3 sm:p-4 md:p-6 overflow-y-auto",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-auto my-auto shadow-xl",children:[e.jsx("div",{className:"sticky top-0 bg-white z-10 px-4 sm:px-6 pt-4 sm:pt-6 pb-3 border-b border-gray-200 rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-semibold text-gray-800",children:"Ajouter un nouveau locataire"}),e.jsx("button",{onClick:()=>I(!1),className:"text-gray-400 hover:text-gray-600 p-1 sm:p-2 transition-colors","aria-label":"Fermer",children:e.jsx(L,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]})}),e.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6 max-h-[calc(100vh-200px)] overflow-y-auto",children:e.jsxs("form",{onSubmit:le,className:"space-y-4 sm:space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-5",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Nom complet *"}),e.jsx("input",{type:"text",required:!0,value:n.fullName,onChange:t=>x(s=>({...s,fullName:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Ex: Jean Dupont"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Email *"}),e.jsx("input",{type:"email",required:!0,value:n.email,onChange:t=>x(s=>({...s,email:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"exemple@email.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"T√©l√©phone"}),e.jsx("input",{type:"tel",value:n.phone,onChange:t=>x(s=>({...s,phone:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"+33 6 12 34 56 78"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Statut *"}),e.jsxs("select",{required:!0,value:n.status||"ACTIVE",onChange:t=>x(s=>({...s,status:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all bg-white",children:[e.jsx("option",{value:"ACTIVE",children:"Actif"}),e.jsx("option",{value:"INACTIVE",children:"Inactif"}),e.jsx("option",{value:"EXPIRED",children:"Expir√©"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Adresse"}),e.jsx("input",{type:"text",value:n.address,onChange:t=>x(s=>({...s,address:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Entrez l'adresse du locataire"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Propri√©t√© *"}),e.jsxs("select",{required:!0,value:n.propertyId,onChange:t=>x(s=>({...s,propertyId:t.target.value})),disabled:y,className:`w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all bg-white ${y?"bg-gray-100 cursor-not-allowed opacity-60":""}`,children:[e.jsx("option",{value:"",children:y?"Chargement des propri√©t√©s...":"S√©lectionnez une propri√©t√©"}),p.map(t=>e.jsx("option",{value:String(t.id),children:t.title},t.id))]}),v&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 mt-1.5",children:v})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Date d'entr√©e"}),e.jsx("input",{type:"date",value:n.checkInDate,onChange:t=>x(s=>({...s,checkInDate:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Date de sortie"}),e.jsx("input",{type:"date",value:n.checkOutDate,onChange:t=>x(s=>({...s,checkOutDate:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Montant du loyer (‚Ç¨)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:n.rent,onChange:t=>x(s=>({...s,rent:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Montant des charges (‚Ç¨)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:n.charges,onChange:t=>x(s=>({...s,charges:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"0.00"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 sm:gap-4 pt-4 sm:pt-5 mt-4 sm:mt-5 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>I(!1),className:"w-full sm:w-auto px-5 sm:px-6 py-2.5 sm:py-3 text-sm sm:text-base font-medium text-gray-700 bg-white border-2 border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all duration-200",children:"Annuler"}),e.jsx("button",{type:"submit",className:"w-full sm:w-auto px-5 sm:px-6 py-2.5 sm:py-3 text-sm sm:text-base font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 shadow-sm hover:shadow-md",children:"Ajouter le locataire"})]})]})})]})}),A&&e.jsx(Ne,{tenantId:Number(A.id),tenantName:A.fullName||A.name||"Inconnu",onClose:()=>M(null)}),G&&O&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-3 sm:p-4 md:p-6 overflow-y-auto",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-auto my-auto shadow-xl",children:[e.jsx("div",{className:"sticky top-0 bg-white z-10 px-4 sm:px-6 pt-4 sm:pt-6 pb-3 border-b border-gray-200 rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-semibold text-gray-800",children:"Modifier le locataire"}),e.jsx("button",{onClick:()=>{T(!1),_(null),u({fullName:"",email:"",phone:"",address:"",propertyId:"",checkInDate:"",checkOutDate:"",documents:[],rent:"",charges:"",status:"ACTIVE"})},className:"text-gray-400 hover:text-gray-600 p-1 sm:p-2 transition-colors","aria-label":"Fermer",children:e.jsx(L,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]})}),e.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6 max-h-[calc(100vh-200px)] overflow-y-auto",children:e.jsxs("form",{onSubmit:ce,className:"space-y-4 sm:space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-5",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Nom complet *"}),e.jsx("input",{type:"text",required:!0,value:o.fullName,onChange:t=>u(s=>({...s,fullName:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Ex: Jean Dupont"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Email *"}),e.jsx("input",{type:"email",required:!0,value:o.email,onChange:t=>u(s=>({...s,email:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"exemple@email.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"T√©l√©phone"}),e.jsx("input",{type:"tel",value:o.phone,onChange:t=>u(s=>({...s,phone:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"+33 6 12 34 56 78"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Statut *"}),e.jsxs("select",{required:!0,value:o.status||"ACTIVE",onChange:t=>u(s=>({...s,status:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all bg-white",children:[e.jsx("option",{value:"ACTIVE",children:"Actif"}),e.jsx("option",{value:"INACTIVE",children:"Inactif"}),e.jsx("option",{value:"EXPIRED",children:"Expir√©"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Adresse"}),e.jsx("input",{type:"text",value:o.address,onChange:t=>u(s=>({...s,address:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Entrez l'adresse du locataire"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Propri√©t√© *"}),e.jsxs("select",{required:!0,value:o.propertyId,onChange:t=>u(s=>({...s,propertyId:t.target.value})),disabled:y,className:`w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all bg-white ${y?"bg-gray-100 cursor-not-allowed opacity-60":""}`,children:[e.jsx("option",{value:"",children:y?"Chargement des propri√©t√©s...":"S√©lectionnez une propri√©t√©"}),p.map(t=>e.jsx("option",{value:String(t.id),children:t.title},t.id))]}),v&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 mt-1.5",children:v})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Date d'entr√©e"}),e.jsx("input",{type:"date",value:o.checkInDate,onChange:t=>u(s=>({...s,checkInDate:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Date de sortie"}),e.jsx("input",{type:"date",value:o.checkOutDate,onChange:t=>u(s=>({...s,checkOutDate:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Montant du loyer (‚Ç¨)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:o.rent,onChange:t=>u(s=>({...s,rent:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm sm:text-base font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Montant des charges (‚Ç¨)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:o.charges,onChange:t=>u(s=>({...s,charges:t.target.value})),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"0.00"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 sm:gap-4 pt-4 sm:pt-5 mt-4 sm:mt-5 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>{T(!1),_(null),u({fullName:"",email:"",phone:"",address:"",propertyId:"",checkInDate:"",checkOutDate:"",documents:[],rent:"",charges:"",status:"ACTIVE"})},className:"w-full sm:w-auto px-5 sm:px-6 py-2.5 sm:py-3 text-sm sm:text-base font-medium text-gray-700 bg-white border-2 border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all duration-200",children:"Annuler"}),e.jsx("button",{type:"submit",className:"w-full sm:w-auto px-5 sm:px-6 py-2.5 sm:py-3 text-sm sm:text-base font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 shadow-sm hover:shadow-md",children:"Mettre √† jour le locataire"})]})]})})]})}),F.isOpen&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 md:p-6 w-full max-w-md mx-4 shadow-xl",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 rounded-full",children:e.jsx(q,{className:"w-6 h-6 text-red-600"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 text-center mb-2",children:"Supprimer le locataire"}),e.jsxs("p",{className:"text-gray-600 text-center mb-6",children:["√ätes-vous s√ªr de vouloir supprimer ",e.jsx("strong",{children:F.tenantName})," ? Cette action est irr√©versible et toutes les donn√©es associ√©es seront supprim√©es."]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-3",children:[e.jsx("button",{onClick:de,disabled:c,className:"w-full sm:w-auto px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm md:text-base",children:"Annuler"}),e.jsx("button",{onClick:ie,disabled:c,className:"w-full sm:w-auto px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2 text-sm md:text-base",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Suppression..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{children:"Supprimer"})]})})]})]})})]})})};export{Ae as default};
