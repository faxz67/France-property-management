import{u as Fe,j as e}from"./index-DsBGyFQG.js";import{r as f}from"./router-DUq0sin2.js";import j from"./api-Bqs0zQX7.js";import{d as O}from"./Dashboard-CWmwHOAq.js";/* empty css                            */import{R as Ce,s as te,Z as Oe,z as _e,e as ae,I as M,F as Ve,D as $e,f as G,J as Ue,a as Le,H as Me,b as Ge,d as J,x as ze}from"./icons-B5_qnxFz.js";import"./vendor-Bzgz95E1.js";import"./utils-B9HHbEsj.js";import"./charts-DdKZH6bc.js";const qe=d=>{if(!d)return"";const _=new Date(d);if(isNaN(_.getTime()))return"";const N=_.getDate().toString().padStart(2,"0"),w=(_.getMonth()+1).toString().padStart(2,"0"),A=_.getFullYear();return`${N}/${w}/${A}`},st=()=>{const{t:d,language:_}=Fe(),[N,w]=f.useState([]),[A,k]=f.useState(null),[V,B]=f.useState(!0),[se,v]=f.useState(null),[ve,K]=f.useState(!1),[m,z]=f.useState(null),[b,q]=f.useState(null),[H,ne]=f.useState(null),[re,oe]=f.useState(null),[D,Z]=f.useState([]),[$,le]=f.useState(!1),[U,we]=f.useState({status:"",search:"",page:1,limit:10}),[He]=f.useState({total:0,page:1,limit:10,totalPages:0}),[E,P]=f.useState(()=>{const t=O.getNewBillDefaults();return{tenant_id:0,property_id:0,amount:0,charges:0,month:t.month,payment_date:"",description:t.description}}),[W,S]=f.useState([]),[L,T]=f.useState([]),[Ee,ie]=f.useState(!1),[je,de]=f.useState(!1),[be,ce]=f.useState(!1),[Y,me]=f.useState(!1);f.useEffect(()=>{De()},[U]),f.useEffect(()=>{if(N.length>0){console.log("ðŸ”„ Recalculating stats from bills...");const t=new Date;t.setHours(0,0,0,0);let s=0,o=0,r=0,l=0,n=0,c=0,g=0;N.forEach(u=>{const p=u.total_amount||u.amount||0;s+=p;const a=u.due_date?new Date(u.due_date):null;let i=!1;a&&(a.setHours(0,0,0,0),i=a<t&&u.status!=="PAID"),u.status==="PAID"?(g++,l+=p):u.status==="PENDING"?(o++,n+=p,i&&(r++,c+=p)):(u.status==="OVERDUE"||i)&&(r++,c+=p,o++,n+=p)});const h={totalBills:N.length,totalAmount:s,pendingBills:o,overdueBills:r,statusBreakdown:[{status:"PAID",count:g,total_amount:l},{status:"PENDING",count:o,total_amount:n},{status:"OVERDUE",count:r,total_amount:c}]};k(h),console.log("âœ… Stats updated:",h)}},[N]);const De=async()=>{console.log("ðŸš€ Loading initial data...");try{const t=localStorage.getItem("token");if(!t){console.log("âŒ No token, using mock data"),X();return}(await fetch("http://192.168.1.109:4002/api/bills",{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}})).ok?(console.log("âœ… Server is available, loading real data"),await I(),await R(),await ue(),await pe()):(console.log("âŒ Server not available, using mock data"),X())}catch{console.log("âŒ Server connectivity test failed, using mock data"),X()}},X=()=>{console.log("ðŸ”„ Loading mock data...");const t=[{id:1,tenant_id:1,property_id:1,admin_id:3,amount:1e3,rent_amount:1e3,charges:0,total_amount:1e3,month:"2025-01",bill_date:"2025-01-01",due_date:"2025-01-15",payment_date:void 0,status:"PENDING",description:"Paiement de loyer mensuel",created_at:"2025-01-01T00:00:00Z",updated_at:"2025-01-01T00:00:00Z",tenant:{id:1,name:"Mohamed FaisalPortfolio Faisal",email:"faisal786mf7@gmail.com",phone:"+1234567890"},property:{id:1,title:"Test Property 1",address:"123 Test Street",city:"Paris"},created_at_fr:"01/01/2025",due_date_fr:"15/01/2025",payment_date_fr:void 0,amount_formatted:"1 000,00 â‚¬",rent_amount_formatted:"1 000,00 â‚¬",charges_formatted:"0,00 â‚¬",total_amount_formatted:"1 000,00 â‚¬",is_overdue:!1,days_until_due:14,status_fr:"En attente",priority:"low",tenant_display_name:"Mohamed FaisalPortfolio Faisal",property_display_name:"Test Property 1"},{id:2,tenant_id:2,property_id:2,admin_id:4,amount:1200,rent_amount:1200,charges:0,total_amount:1200,month:"2025-01",bill_date:"2025-01-01",due_date:"2025-01-10",payment_date:"2025-01-05",status:"PAID",description:"Paiement de loyer mensuel",created_at:"2025-01-01T00:00:00Z",updated_at:"2025-01-05T00:00:00Z",tenant:{id:2,name:"Mohamed Faisal",email:"faisal786mf7@gmail.com",phone:"+1234567890"},property:{id:2,title:"Test Property 2",address:"456 Test Avenue",city:"Lyon"},created_at_fr:"01/01/2025",due_date_fr:"10/01/2025",payment_date_fr:"05/01/2025",amount_formatted:"1 200,00 â‚¬",rent_amount_formatted:"1 200,00 â‚¬",charges_formatted:"0,00 â‚¬",total_amount_formatted:"1 200,00 â‚¬",is_overdue:!1,days_until_due:-5,status_fr:"PayÃ©",priority:"low",tenant_display_name:"Mohamed Faisal",property_display_name:"Test Property 2"},{id:3,tenant_id:3,property_id:3,admin_id:1,amount:800,rent_amount:800,charges:0,total_amount:800,month:"2024-12",bill_date:"2024-12-01",due_date:"2024-12-15",payment_date:void 0,status:"OVERDUE",description:"Paiement de loyer mensuel",created_at:"2024-12-01T00:00:00Z",updated_at:"2024-12-01T00:00:00Z",tenant:{id:3,name:"Locataire Admin 1",email:"locataire.admin1@test.com",phone:"+1234567890"},property:{id:3,title:"Test Property 3",address:"789 Test Boulevard",city:"Marseille"},created_at_fr:"01/12/2024",due_date_fr:"15/12/2024",payment_date_fr:void 0,amount_formatted:"800,00 â‚¬",rent_amount_formatted:"800,00 â‚¬",charges_formatted:"0,00 â‚¬",total_amount_formatted:"800,00 â‚¬",is_overdue:!0,days_until_due:-17,status_fr:"En retard",priority:"critical",tenant_display_name:"Locataire Admin 1",property_display_name:"Test Property 3"}],s={totalBills:3,totalAmount:3e3,pendingBills:1,overdueBills:1,statusBreakdown:[{status:"PAID",count:1,total_amount:1200},{status:"PENDING",count:1,total_amount:1e3},{status:"OVERDUE",count:1,total_amount:800}]},o=[{id:1,name:"Mohamed FaisalPortfolio Faisal",email:"faisal786mf7@gmail.com",phone:"+1234567890",admin_id:3,property_id:1,status:"ACTIVE",rent_amount:1e3,display_name:"Mohamed FaisalPortfolio Faisal (faisal786mf7@gmail.com)",property:{id:1,title:"Test Property 1",address:"123 Test Street",monthly_rent:1e3},admin:{id:3,name:"Mohamed Faisal",email:"faisal@property.com"}},{id:2,name:"Mohamed Faisal",email:"faisal786mf7@gmail.com",phone:"+1234567890",admin_id:4,property_id:2,status:"ACTIVE",rent_amount:1200,display_name:"Mohamed Faisal (faisal786mf7@gmail.com)",property:{id:2,title:"Test Property 2",address:"456 Test Avenue",monthly_rent:1200},admin:{id:4,name:"Mohamed Rahim",email:"rahim@property.com"}},{id:3,name:"Locataire Admin 1",email:"locataire.admin1@test.com",phone:"+1234567890",admin_id:1,property_id:3,status:"ACTIVE",rent_amount:800,display_name:"Locataire Admin 1 (locataire.admin1@test.com)",property:{id:3,title:"Test Property 3",address:"789 Test Boulevard",monthly_rent:800},admin:{id:1,name:"Default Admin",email:"admin@example.com"}}],r=[{id:1,title:"Test Property 1",address:"123 Test Street",monthly_rent:1e3,admin_id:3,display_name:"Test Property 1 - 123 Test Street"},{id:2,title:"Test Property 2",address:"456 Test Avenue",monthly_rent:1200,admin_id:4,display_name:"Test Property 2 - 456 Test Avenue"},{id:3,title:"Test Property 3",address:"789 Test Boulevard",monthly_rent:800,admin_id:1,display_name:"Test Property 3 - 789 Test Boulevard"}];w(t),k(s),S(o),T(r),B(!1),v(""),console.log("ðŸ“Š Mock data loaded successfully:",{bills:t.length,stats:s,tenants:o.length,properties:r.length})},I=async(t=!1)=>{try{t||B(!0),v(""),console.log("ðŸ” Fetching bills with filters:",U),O.clearCache();const s=localStorage.getItem("token");if(console.log("ðŸ”‘ Token exists:",!!s),!s){console.error("âŒ No authentication token found"),v("Token d'authentification manquant"),w([]);return}const o=await j.listBills(U);if(console.log("ðŸ“¡ Bills API Response:",o.data),o.data?.success&&o.data?.data?.bills){const r=o.data.data.bills;console.log("ðŸ“‹ Raw bills from API:",r.length,"bills"),r.length>0&&console.log("ðŸ” Sample bill structure:",{id:r[0].id,tenant:r[0].tenant,property:r[0].property,tenant_keys:r[0].tenant?Object.keys(r[0].tenant):"null"});const l=r.map(n=>{try{const c=n.payment_date?new Date(n.payment_date):null,g=n.due_date?new Date(n.due_date):null,h=n.created_at?new Date(n.created_at):null,u=new Date;u.setHours(0,0,0,0);let p=!1,a=null;g&&!isNaN(g.getTime())&&(g.setHours(0,0,0,0),p=g<u,a=Math.ceil((g.getTime()-u.getTime())/(1e3*60*60*24)));let i=d("payments.tenant");n.tenant?i=n.tenant.name||n.tenant.fullName||(n.tenant.firstName&&n.tenant.lastName?`${n.tenant.firstName} ${n.tenant.lastName}`:null)||`${d("payments.tenant")} ${n.tenant.id}`||d("payments.tenant"):console.warn(`âš ï¸ Bill ${n.id} has no tenant data`);let y=d("payments.property");return n.property?y=n.property.title||n.property.name||n.property.propertyName||`${d("payments.property")} ${n.property.id}`||d("payments.property"):console.warn(`âš ï¸ Bill ${n.id} has no property data`),{...n,created_at_fr:h&&!isNaN(h.getTime())?h.toLocaleDateString(_==="fr"?"fr-FR":"en-US"):d("payments.nA"),due_date_fr:g&&!isNaN(g.getTime())?g.toLocaleDateString(_==="fr"?"fr-FR":"en-US"):null,payment_date_fr:c&&!isNaN(c.getTime())?c.toLocaleDateString(_==="fr"?"fr-FR":"en-US"):null,amount_formatted:new Intl.NumberFormat(_==="fr"?"fr-FR":"en-US",{style:"currency",currency:"EUR"}).format(n.amount||n.total_amount||0),rent_amount_formatted:n.rent_amount?new Intl.NumberFormat(_==="fr"?"fr-FR":"en-US",{style:"currency",currency:"EUR"}).format(n.rent_amount):null,charges_formatted:n.charges?new Intl.NumberFormat(_==="fr"?"fr-FR":"en-US",{style:"currency",currency:"EUR"}).format(n.charges):null,total_amount_formatted:new Intl.NumberFormat(_==="fr"?"fr-FR":"en-US",{style:"currency",currency:"EUR"}).format(n.total_amount||n.amount||0),is_overdue:p,days_until_due:a||0,status_fr:n.status==="PENDING"?d("payments.status.pending"):n.status==="PAID"?d("payments.status.paid"):n.status==="OVERDUE"?d("payments.status.overdue"):n.status==="RECEIPT_SENT"?d("payments.status.receipt_sent"):n.status||d("common.error"),priority:n.status==="PAID"?"low":p?"critical":a!==null&&a<=3?"high":a!==null&&a<=7?"medium":"low",tenant_display_name:i,property_display_name:y}}catch(c){return console.error("âŒ Error processing bill:",n.id,c),{...n,created_at_fr:"N/A",due_date_fr:null,payment_date_fr:null,amount_formatted:"â‚¬0.00",rent_amount_formatted:null,charges_formatted:null,total_amount_formatted:"â‚¬0.00",is_overdue:!1,days_until_due:0,status_fr:n.status||"Inconnu",priority:"low",tenant_display_name:n.tenant?.name||n.tenant?.fullName||(n.tenant?.firstName&&n.tenant?.lastName?`${n.tenant.firstName} ${n.tenant.lastName}`:null)||(n.tenant?`Locataire ${n.tenant.id}`:"Locataire")||"Locataire",property_display_name:n.property?.title||n.property?.name||n.property?.propertyName||(n.property?`PropriÃ©tÃ© ${n.property.id}`:"PropriÃ©tÃ©")||"PropriÃ©tÃ©"}}});return console.log("âœ… Bills processed with French formatting:",l.length,"bills"),w(l),l}else return console.log("âŒ Invalid bills response structure:",o.data),w([]),[]}catch(s){console.error("âŒ Error fetching bills:",s),console.error("âŒ Error details:",{message:s.message,response:s.response?.data,status:s.response?.status,stack:s.stack});const o=s.response?.data?.message||s.message||"Erreur lors de la rÃ©cupÃ©ration des factures";return v(o),w([]),B(!1),console.log("âŒ Bills fetch failed. Showing error to user."),[]}finally{t||B(!1)}},Pe=async t=>{try{if(!window.confirm("Supprimer cette facture ? Cette action est irrÃ©versible."))return;oe(t),v("");const o=await j.deleteBill(t);o?.data?.success?(w(r=>r.filter(l=>l.id!==t)),await R()):v(o?.data?.message||"Ã‰chec de la suppression de la facture")}catch(s){v(s?.userMessage||s?.message||"Erreur lors de la suppression")}finally{oe(null)}},R=async()=>{try{O.clearCache();const t=await j.getBillsStats();if(t.data?.success&&t.data?.data){const s=t.data.data;console.log("ðŸ“Š Raw stats from API:",s);const o={totalBills:s.totalBills||s.total||0,totalAmount:s.totalAmount||s.total_amount||0,pendingBills:s.pendingBills||s.pending||0,overdueBills:s.overdueBills||s.overdue||0,statusBreakdown:[{status:"PAID",count:s.paid||0,total_amount:s.paid_amount||0},{status:"PENDING",count:s.pendingBills||s.pending||0,total_amount:s.pending_amount||0},{status:"OVERDUE",count:s.overdueBills||s.overdue||0,total_amount:s.overdue_amount||0}]};k(o),console.log("âœ… Stats loaded from API:",o)}}catch(t){console.error("âŒ Failed to fetch stats from API:",t),console.log("ðŸ”„ Calculating stats from loaded bills...");let s=N.length>0?N:[];if(s.length===0){const r=await I();s=Array.isArray(r)?r:[]}let o;if(s.length>0){const r=new Date;r.setHours(0,0,0,0);let l=0,n=0,c=0,g=0,h=0,u=0;s.forEach(p=>{const a=p.total_amount||p.amount||0;l+=a;const i=p.due_date?new Date(p.due_date):null;let y=!1;i&&(i.setHours(0,0,0,0),y=i<r&&p.status!=="PAID"),p.status==="PAID"?g+=a:p.status==="PENDING"?(n++,h+=a,y&&(c++,u+=a)):(p.status==="OVERDUE"||y)&&(c++,u+=a,n++,h+=a)}),o={totalBills:s.length,totalAmount:l,pendingBills:n,overdueBills:c,statusBreakdown:[{status:"PAID",count:s.filter(p=>p.status==="PAID").length,total_amount:g},{status:"PENDING",count:n,total_amount:h},{status:"OVERDUE",count:c,total_amount:u}]}}else o={totalBills:3,totalAmount:3e3,pendingBills:2,overdueBills:1,statusBreakdown:[{status:"PAID",count:0,total_amount:0},{status:"PENDING",count:2,total_amount:2e3},{status:"OVERDUE",count:1,total_amount:1e3}]};k(o),console.log("ðŸ“Š Stats calculated from bills:",o)}},ue=async()=>{try{if(O.clearCache(),!localStorage.getItem("token")){console.error("âŒ No authentication token found for tenants fetch"),S([]);return}console.log("ðŸ” Fetching tenants from database...");const s=await j.listTenants();console.log("ðŸ” Tenants API Response:",s),console.log("ðŸ” Response status:",s.status),console.log("ðŸ” Response data:",s.data);let o=[];if(s.data?.success&&s.data?.data)o=s.data.data,console.log("ðŸ“‹ Using response.data.data structure");else if(s.data&&Array.isArray(s.data))o=s.data,console.log("ðŸ“‹ Using direct array structure");else if(s.data?.tenants)o=s.data.tenants,console.log("ðŸ“‹ Using response.data.tenants structure");else if(s.data?.results)o=s.data.results,console.log("ðŸ“‹ Using response.data.results structure");else{console.log("âŒ Unknown response structure:",s.data),console.log("âŒ Available keys:",Object.keys(s.data||{})),S([]);return}if(Array.isArray(o)&&o.length>0){console.log("ðŸ“‹ Raw tenants from API:",o.length,"tenants"),console.log("ðŸ“‹ Raw tenants structure:",o);const r=o.map(l=>(console.log("ðŸ”„ Processing tenant:",l),{...l,created_at_fr:l.created_at?new Date(l.created_at).toLocaleDateString("fr-FR"):"N/A",display_name:l.name||l.fullName||(l.firstName&&l.lastName?`${l.firstName} ${l.lastName}`:null)||`Locataire ${l.id}`,property_display_name:l.property?.title||l.property?.name||"PropriÃ©tÃ©"}));S(r),console.log("âœ… Tenants processed with French formatting:",r.length,"tenants"),console.log("ðŸ“ Tenant names for dropdown:",r.map(l=>({id:l.id,name:l.name,fullName:l.fullName,firstName:l.firstName,lastName:l.lastName,display_name:l.display_name})))}else console.log("âŒ No tenants found or invalid data structure"),console.log("âŒ Raw tenants:",o),S([])}catch(t){console.error("âŒ Failed to fetch tenants:",t),console.error("âŒ Error details:",{message:t.message,status:t.response?.status,data:t.response?.data}),S([])}},pe=async()=>{try{if(O.clearCache(),!localStorage.getItem("token")){console.error("âŒ No authentication token found for properties fetch"),T([]);return}console.log("ðŸ” Fetching properties from database...");const s=await j.listProperties();console.log("ðŸ” Properties API Response:",s),console.log("ðŸ” Response status:",s.status),console.log("ðŸ” Response data:",s.data);let o=[];if(s.data?.success&&s.data?.data)o=s.data.data,console.log("ðŸ“‹ Using response.data.data structure");else if(s.data&&Array.isArray(s.data))o=s.data,console.log("ðŸ“‹ Using direct array structure");else if(s.data?.properties)o=s.data.properties,console.log("ðŸ“‹ Using response.data.properties structure");else if(s.data?.results)o=s.data.results,console.log("ðŸ“‹ Using response.data.results structure");else{console.log("âŒ Unknown response structure:",s.data),console.log("âŒ Available keys:",Object.keys(s.data||{})),T([]);return}if(Array.isArray(o)&&o.length>0){console.log("ðŸ“‹ Raw properties from API:",o.length,"properties"),console.log("ðŸ“‹ Raw properties structure:",o);const r=o.map(l=>(console.log("ðŸ”„ Processing property:",l),{...l,created_at_fr:l.created_at?new Date(l.created_at).toLocaleDateString("fr-FR"):"N/A",display_name:l.title||l.name||l.propertyName||`PropriÃ©tÃ© ${l.id}`,rent_formatted:l.rent?new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(l.rent):null}));T(r),console.log("âœ… Properties processed with French formatting:",r.length,"properties"),console.log("ðŸ“ Property titles for dropdown:",r.map(l=>({id:l.id,title:l.title,name:l.name,propertyName:l.propertyName,display_name:l.display_name})))}else console.log("âŒ No properties found or invalid data structure"),console.log("âŒ Raw properties:",o),T([])}catch(t){console.error("âŒ Failed to fetch properties:",t),console.error("âŒ Error details:",{message:t.message,status:t.response?.status,data:t.response?.data}),T([])}},Ae=async()=>{try{console.log("ðŸš€ [SENIOR DEV] Loading data for create bill with advanced diagnostics...");const t=localStorage.getItem("token");if(!t)return console.error("âŒ [SENIOR DEV] No authentication token"),alert("âŒ Vous devez Ãªtre connectÃ© pour crÃ©er une facture"),{tenants:[],properties:[]};try{const a=JSON.parse(atob(t.split(".")[1]));console.log("ðŸ” [SENIOR DEV] Token payload:",a),console.log("ðŸ‘¤ [SENIOR DEV] Admin ID:",a.id),console.log("ðŸ‘¤ [SENIOR DEV] Admin Role:",a.role)}catch{console.warn("âš ï¸ [SENIOR DEV] Could not decode token payload")}const s="http://192.168.1.109:4002/api";console.log("ðŸŒ [SENIOR DEV] API Base URL:",s),console.log("ðŸ§ª [SENIOR DEV] Testing API connectivity...");const o=await fetch(`${s}/tenants`,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(console.log("ðŸ§ª [SENIOR DEV] Connectivity test status:",o.status),console.log("ðŸ§ª [SENIOR DEV] Connectivity test headers:",Object.fromEntries(o.headers.entries())),!o.ok){const a=await o.text();console.error("âŒ [SENIOR DEV] API connectivity failed:",o.status,a),console.log("ðŸ”„ [SENIOR DEV] Server not available, using mock data...");const i=[{id:1,name:"Mohamed FaisalPortfolio Faisal",email:"faisal786mf7@gmail.com",phone:"+1234567890",admin_id:3,property_id:1,status:"ACTIVE",rent_amount:1e3,display_name:"Mohamed FaisalPortfolio Faisal (faisal786mf7@gmail.com)",property:{id:1,title:"Test Property 1",address:"123 Test Street",monthly_rent:1e3},admin:{id:3,name:"Mohamed Faisal",email:"faisal@property.com"}},{id:2,name:"Mohamed Faisal",email:"faisal786mf7@gmail.com",phone:"+1234567890",admin_id:4,property_id:2,status:"ACTIVE",rent_amount:1200,display_name:"Mohamed Faisal (faisal786mf7@gmail.com)",property:{id:2,title:"Test Property 2",address:"456 Test Avenue",monthly_rent:1200},admin:{id:4,name:"Mohamed Rahim",email:"rahim@property.com"}},{id:3,name:"Locataire Admin 1",email:"locataire.admin1@test.com",phone:"+1234567890",admin_id:1,property_id:3,status:"ACTIVE",rent_amount:800,display_name:"Locataire Admin 1 (locataire.admin1@test.com)",property:{id:3,title:"Test Property 3",address:"789 Test Boulevard",monthly_rent:800},admin:{id:1,name:"Default Admin",email:"admin@example.com"}}],y=[{id:1,title:"Test Property 1",address:"123 Test Street",monthly_rent:1e3,admin_id:3,display_name:"Test Property 1 - 123 Test Street"},{id:2,title:"Test Property 2",address:"456 Test Avenue",monthly_rent:1200,admin_id:4,display_name:"Test Property 2 - 456 Test Avenue"},{id:3,title:"Test Property 3",address:"789 Test Boulevard",monthly_rent:800,admin_id:1,display_name:"Test Property 3 - 789 Test Boulevard"}];return console.log("ðŸ“Š [SENIOR DEV] Mock data loaded:",{tenants:i.length,properties:y.length}),{tenants:i,properties:y}}console.log("ðŸ‘¥ [SENIOR DEV] Fetching tenants with detailed diagnostics...");let r,l=`${s}/bills/create-data/tenants`;try{r=await fetch(l,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}}),console.log("ðŸ‘¥ [SENIOR DEV] Bill creation tenants endpoint status:",r.status),r.status===403&&(console.log("ðŸ‘¥ [SENIOR DEV] 403 error, trying fallback endpoint..."),l=`${s}/tenants`,r=await fetch(l,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}}),console.log("ðŸ‘¥ [SENIOR DEV] Fallback tenants endpoint status:",r.status))}catch(a){console.error("ðŸ‘¥ [SENIOR DEV] Error fetching tenants:",a),r={ok:!1,status:500}}console.log("ðŸ‘¥ [SENIOR DEV] Tenants response status:",r.status),console.log("ðŸ‘¥ [SENIOR DEV] Tenants response headers:",r.headers?Object.fromEntries(r.headers.entries()):"No headers");let n=[];if(r.ok&&"json"in r){const a=await r.json();if(console.log("ðŸ‘¥ [SENIOR DEV] Raw tenants response:",a),console.log("ðŸ‘¥ [SENIOR DEV] Tenants data type:",typeof a),console.log("ðŸ‘¥ [SENIOR DEV] Tenants data keys:",Object.keys(a||{})),a.success&&Array.isArray(a.data))n=a.data,console.log("ðŸ‘¥ [SENIOR DEV] Using tenantsData.data structure");else if(Array.isArray(a))n=a,console.log("ðŸ‘¥ [SENIOR DEV] Using direct array structure");else if(a.tenants&&Array.isArray(a.tenants))n=a.tenants,console.log("ðŸ‘¥ [SENIOR DEV] Using tenantsData.tenants structure");else if(a.results&&Array.isArray(a.results))n=a.results,console.log("ðŸ‘¥ [SENIOR DEV] Using tenantsData.results structure");else{console.log("ðŸ‘¥ [SENIOR DEV] Unknown structure, searching for arrays...");for(const[i,y]of Object.entries(a))if(Array.isArray(y)){console.log(`ðŸ‘¥ [SENIOR DEV] Found array in key '${i}' with ${y.length} items`),n=y;break}}console.log("ðŸ‘¥ [SENIOR DEV] Extracted tenants count:",n.length),n.length>0&&console.log("ðŸ‘¥ [SENIOR DEV] Sample tenant:",n[0])}else{const a="text"in r?await r.text():"Unknown error";console.error("âŒ [SENIOR DEV] Failed to fetch tenants:",r.status,a),console.log("ðŸ”„ [SENIOR DEV] Using mock tenants as fallback..."),n=[{id:1,name:"Mohamed FaisalPortfolio Faisal",email:"faisal786mf7@gmail.com",phone:"+1234567890",admin_id:3,property_id:1,status:"ACTIVE",rent_amount:1e3,display_name:"Mohamed FaisalPortfolio Faisal (faisal786mf7@gmail.com)",property:{id:1,title:"Test Property 1",address:"123 Test Street",monthly_rent:1e3},admin:{id:3,name:"Mohamed Faisal",email:"faisal@property.com"}},{id:2,name:"Mohamed Faisal",email:"faisal786mf7@gmail.com",phone:"+1234567890",admin_id:4,property_id:2,status:"ACTIVE",rent_amount:1200,display_name:"Mohamed Faisal (faisal786mf7@gmail.com)",property:{id:2,title:"Test Property 2",address:"456 Test Avenue",monthly_rent:1200},admin:{id:4,name:"Mohamed Rahim",email:"rahim@property.com"}},{id:3,name:"Locataire Admin 1",email:"locataire.admin1@test.com",phone:"+1234567890",admin_id:1,property_id:3,status:"ACTIVE",rent_amount:800,display_name:"Locataire Admin 1 (locataire.admin1@test.com)",property:{id:3,title:"Test Property 3",address:"789 Test Boulevard",monthly_rent:800},admin:{id:1,name:"Default Admin",email:"admin@example.com"}}]}console.log("ðŸ  [SENIOR DEV] Fetching properties with detailed diagnostics...");let c,g=`${s}/bills/create-data/properties`;try{c=await fetch(g,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}}),console.log("ðŸ  [SENIOR DEV] Bill creation properties endpoint status:",c.status),c.status===403&&(console.log("ðŸ  [SENIOR DEV] 403 error, trying fallback endpoint..."),g=`${s}/properties`,c=await fetch(g,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}}),console.log("ðŸ  [SENIOR DEV] Fallback properties endpoint status:",c.status))}catch(a){console.error("ðŸ  [SENIOR DEV] Error fetching properties:",a),c={ok:!1,status:500}}console.log("ðŸ  [SENIOR DEV] Properties response status:",c.status),console.log("ðŸ  [SENIOR DEV] Properties response headers:",c.headers?Object.fromEntries(c.headers.entries()):"No headers");let h=[];if(c.ok&&"json"in c){const a=await c.json();if(console.log("ðŸ  [SENIOR DEV] Raw properties response:",a),console.log("ðŸ  [SENIOR DEV] Properties data type:",typeof a),console.log("ðŸ  [SENIOR DEV] Properties data keys:",Object.keys(a||{})),a.success&&Array.isArray(a.data))h=a.data,console.log("ðŸ  [SENIOR DEV] Using propertiesData.data structure");else if(Array.isArray(a))h=a,console.log("ðŸ  [SENIOR DEV] Using direct array structure");else if(a.properties&&Array.isArray(a.properties))h=a.properties,console.log("ðŸ  [SENIOR DEV] Using propertiesData.properties structure");else if(a.results&&Array.isArray(a.results))h=a.results,console.log("ðŸ  [SENIOR DEV] Using propertiesData.results structure");else{console.log("ðŸ  [SENIOR DEV] Unknown structure, searching for arrays...");for(const[i,y]of Object.entries(a))if(Array.isArray(y)){console.log(`ðŸ  [SENIOR DEV] Found array in key '${i}' with ${y.length} items`),h=y;break}}console.log("ðŸ  [SENIOR DEV] Extracted properties count:",h.length),h.length>0&&console.log("ðŸ  [SENIOR DEV] Sample property:",h[0])}else{const a="text"in c?await c.text():"Unknown error";console.error("âŒ [SENIOR DEV] Failed to fetch properties:",c.status,a),console.log("ðŸ”„ [SENIOR DEV] Using mock properties as fallback..."),h=[{id:1,title:"Test Property 1",address:"123 Test Street",monthly_rent:1e3,admin_id:3,display_name:"Test Property 1 - 123 Test Street"},{id:2,title:"Test Property 2",address:"456 Test Avenue",monthly_rent:1200,admin_id:4,display_name:"Test Property 2 - 456 Test Avenue"},{id:3,title:"Test Property 3",address:"789 Test Boulevard",monthly_rent:800,admin_id:1,display_name:"Test Property 3 - 789 Test Boulevard"}]}const u=n.map((a,i)=>{try{return{id:a.id,name:a.name||a.fullName||`${a.firstName||""} ${a.lastName||""}`.trim()||`Locataire ${a.id}`,email:a.email||"",phone:a.phone||"",display_name:a.name||a.fullName||`${a.firstName||""} ${a.lastName||""}`.trim()||`Locataire ${a.id}`,property_id:a.property_id,admin_id:a.admin_id,status:a.status}}catch(y){return console.error(`âŒ [SENIOR DEV] Error processing tenant ${i}:`,y),{id:a.id||`unknown_${i}`,name:`Locataire ${a.id||i}`,email:"",phone:"",display_name:`Locataire ${a.id||i}`,property_id:a.property_id,admin_id:a.admin_id,status:a.status}}}),p=h.map((a,i)=>{try{return{id:a.id,title:a.title||a.name||a.propertyName||`PropriÃ©tÃ© ${a.id}`,address:a.address||"",rent:a.rent||a.monthly_rent||0,display_name:a.title||a.name||a.propertyName||`PropriÃ©tÃ© ${a.id}`,admin_id:a.admin_id,city:a.city,country:a.country}}catch(y){return console.error(`âŒ [SENIOR DEV] Error processing property ${i}:`,y),{id:a.id||`unknown_${i}`,title:`PropriÃ©tÃ© ${a.id||i}`,address:"",rent:0,display_name:`PropriÃ©tÃ© ${a.id||i}`,admin_id:a.admin_id,city:a.city,country:a.country}}});return console.log("âœ… [SENIOR DEV] Data processing completed:"),console.log("  - Processed tenants:",u.length),console.log("  - Processed properties:",p.length),u.length>0&&console.log("ðŸ‘¥ [SENIOR DEV] Sample processed tenant:",u[0]),p.length>0&&console.log("ðŸ  [SENIOR DEV] Sample processed property:",p[0]),{tenants:u,properties:p}}catch(t){console.error("âŒ [SENIOR DEV] Critical error in loadDataForCreateBill:",t),console.error("âŒ [SENIOR DEV] Error stack:",t.stack),console.log("ðŸ”„ [SENIOR DEV] Using mock data due to critical error...");const s=[{id:1,name:"Mohamed FaisalPortfolio Faisal",email:"faisal786mf7@gmail.com",phone:"+1234567890",admin_id:3,property_id:1,status:"ACTIVE",rent_amount:1e3,display_name:"Mohamed FaisalPortfolio Faisal (faisal786mf7@gmail.com)",property:{id:1,title:"Test Property 1",address:"123 Test Street",monthly_rent:1e3},admin:{id:3,name:"Mohamed Faisal",email:"faisal@property.com"}},{id:2,name:"Mohamed Faisal",email:"faisal786mf7@gmail.com",phone:"+1234567890",admin_id:4,property_id:2,status:"ACTIVE",rent_amount:1200,display_name:"Mohamed Faisal (faisal786mf7@gmail.com)",property:{id:2,title:"Test Property 2",address:"456 Test Avenue",monthly_rent:1200},admin:{id:4,name:"Mohamed Rahim",email:"rahim@property.com"}},{id:3,name:"Locataire Admin 1",email:"locataire.admin1@test.com",phone:"+1234567890",admin_id:1,property_id:3,status:"ACTIVE",rent_amount:800,display_name:"Locataire Admin 1 (locataire.admin1@test.com)",property:{id:3,title:"Test Property 3",address:"789 Test Boulevard",monthly_rent:800},admin:{id:1,name:"Default Admin",email:"admin@example.com"}}],o=[{id:1,title:"Test Property 1",address:"123 Test Street",monthly_rent:1e3,admin_id:3,display_name:"Test Property 1 - 123 Test Street"},{id:2,title:"Test Property 2",address:"456 Test Avenue",monthly_rent:1200,admin_id:4,display_name:"Test Property 2 - 456 Test Avenue"},{id:3,title:"Test Property 3",address:"789 Test Boulevard",monthly_rent:800,admin_id:1,display_name:"Test Property 3 - 789 Test Boulevard"}];return console.log("ðŸ“Š [SENIOR DEV] Mock data loaded due to error:",{tenants:s.length,properties:o.length}),{tenants:s,properties:o}}},F=()=>{if(m){const t=m.property||null;return{name:(m.admin||null)?.name||t?.title||t?.name||"PropriÃ©taire",company:"Gestion Locative",address:t?.address||"Adresse du bailleur",city:t?.city||"Paris",postalCode:t?.postal_code||"75001",country:t?.country||"France"}}if(L.length>0){const t=L[0];return{name:t.title||"PropriÃ©taire",company:"Gestion Locative",address:t.address||"Adresse du bailleur",city:t.city||"Paris",postalCode:t.postal_code||"75001",country:t.country||"France"}}return{name:"PropriÃ©taire",company:"Gestion Locative",address:"Adresse du bailleur",city:"Paris",postalCode:"75001",country:"France"}},ee=async t=>{try{ne(t);const s=N.find(x=>x.id===t);let o="";if(s&&s.tenant&&(s.tenant?.name||s.tenant?.fullName)&&s.month){const Q=(s.tenant?.name||s.tenant?.fullName||"").trim().replace(/\.\./g,"").replace(/[<>:"|?*\x00-\x1f]/g,"").replace(/[^\p{L}\p{N}\s-]/gu,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").toLowerCase().trim();o=`${Q.length>0&&Q.length<=50?Q:"tenant"}-${s.month}.pdf`,console.log("ðŸ“„ Generated fallback filename from bill data:",o)}const r=localStorage.getItem("token");if(!r)throw new Error("Token d'authentification manquant");const n=`http://192.168.1.109:4002/api/bills/${t}/download`;console.log("ðŸ“¥ Downloading PDF from:",n);const c=await fetch(n,{method:"GET",headers:{Authorization:`Bearer ${r}`,Accept:"application/pdf"}});if(!c.ok){const x=await c.text();throw console.error("âŒ Response error:",c.status,x),new Error(`Download failed (${c.status}): ${c.statusText}`)}const g=c.headers.get("content-type");(!g||!g.includes("application/pdf"))&&console.warn("âš ï¸ Unexpected content type:",g);const h=c.headers.get("content-disposition");let u=o||`bill-${t}.pdf`;if(console.log("ðŸ“¥ Content-Disposition header:",h),h){let x=h.match(/filename\s*=\s*"([^"]+)"/i);if(x&&x[1])u=x[1];else if(x=h.match(/filename\*\s*=\s*UTF-8''([^;]+)/i),x&&x[1])try{u=decodeURIComponent(x[1])}catch{console.warn("Failed to decode UTF-8 filename, using fallback")}else x=h.match(/filename\s*=\s*([^;]+)/i),x&&x[1]&&(u=x[1].trim().replace(/^["']|["']$/g,""))}u.toLowerCase().endsWith(".pdf")||(u=u.replace(/\.[^.]*$/,"")+".pdf"),console.log("ðŸ“¥ Final extracted filename:",u);const p=await c.blob();if(p.size===0)throw new Error("Le fichier PDF tÃ©lÃ©chargÃ© est vide");const a=await p.arrayBuffer(),i=new Uint8Array(a);String.fromCharCode(i[0],i[1],i[2],i[3])!=="%PDF"&&console.warn("âš ï¸ Le fichier tÃ©lÃ©chargÃ© ne semble pas Ãªtre un PDF valide");const Ne=window.URL.createObjectURL(p),C=document.createElement("a");C.href=Ne,C.download=u,C.style.display="none",document.body.appendChild(C),C.click(),document.body.removeChild(C),window.URL.revokeObjectURL(Ne),console.log("âœ… Quittance tÃ©lÃ©chargÃ©e avec succÃ¨s:",u,`(${(p.size/1024).toFixed(1)} KB)`),alert(`âœ… Quittance tÃ©lÃ©chargÃ©e avec succÃ¨s !
Fichier: ${u}
Taille: ${(p.size/1024).toFixed(1)} KB`)}catch(s){console.error("âŒ Erreur de tÃ©lÃ©chargement:",s),alert("âŒ Ã‰chec du tÃ©lÃ©chargement: "+(s.message||"Erreur inconnue"))}finally{ne(null)}},Se=async()=>{if(D.length===0){alert("Veuillez sÃ©lectionner au moins une facture Ã  tÃ©lÃ©charger");return}for(const t of D)await ee(t),await new Promise(s=>setTimeout(s,500));Z([]),alert(`${D.length} facture(s) tÃ©lÃ©chargÃ©e(s) avec succÃ¨s !`)},Te=t=>{Z(s=>s.includes(t)?s.filter(o=>o!==t):[...s,t])},Ie=()=>{D.length===N.length?Z([]):Z(N.map(t=>t.id))},he=async t=>{if(confirm("ÃŠtes-vous sÃ»r de vouloir marquer cette facture comme payÃ©e ?"))try{q(t);try{await j.markBillAsPaid(t),await I(),await R(),alert("Facture marquÃ©e comme payÃ©e avec succÃ¨s !")}catch{console.log("ðŸ”„ API error, updating locally..."),w(o=>{const r=o.map(a=>a.id===t?{...a,status:"PAID",payment_date:new Date().toISOString().split("T")[0],payment_date_fr:new Date().toLocaleDateString("fr-FR"),status_fr:"PayÃ©",priority:"low"}:a),l=r.filter(a=>a.status==="PAID"),n=r.filter(a=>a.status==="PENDING"),c=r.filter(a=>a.status==="OVERDUE"),g=r.reduce((a,i)=>a+(i.total_amount||i.amount||0),0),h=l.reduce((a,i)=>a+(i.total_amount||i.amount||0),0),u=n.reduce((a,i)=>a+(i.total_amount||i.amount||0),0),p=c.reduce((a,i)=>a+(i.total_amount||i.amount||0),0);return k({totalBills:r.length,totalAmount:g,pendingBills:n.length,overdueBills:c.length,statusBreakdown:[{status:"PAID",count:l.length,total_amount:h},{status:"PENDING",count:n.length,total_amount:u},{status:"OVERDUE",count:c.length,total_amount:p}]}),r}),alert("Facture marquÃ©e comme payÃ©e localement ! (Serveur non disponible)")}}catch(s){alert(s.userMessage||"Ã‰chec de la mise Ã  jour de la facture")}finally{q(null)}},ge=async t=>{if(confirm("ÃŠtes-vous sÃ»r de vouloir annuler le paiement de cette facture ? Le montant sera soustrait des profits."))try{q(t);try{await j.undoPayment(t),await I(),await R(),alert("Paiement annulÃ© avec succÃ¨s !")}catch{console.log("ðŸ”„ API error, updating locally..."),w(o=>{const r=o.map(a=>a.id===t?{...a,status:"PENDING",payment_date:void 0,payment_date_fr:void 0,status_fr:"En attente",priority:"medium"}:a),l=r.filter(a=>a.status==="PAID"),n=r.filter(a=>a.status==="PENDING"),c=r.filter(a=>a.status==="OVERDUE"),g=r.reduce((a,i)=>a+(i.total_amount||i.amount||0),0),h=l.reduce((a,i)=>a+(i.total_amount||i.amount||0),0),u=n.reduce((a,i)=>a+(i.total_amount||i.amount||0),0),p=c.reduce((a,i)=>a+(i.total_amount||i.amount||0),0);return k({totalBills:r.length,totalAmount:g,pendingBills:n.length,overdueBills:c.length,statusBreakdown:[{status:"PAID",count:l.length,total_amount:h},{status:"PENDING",count:n.length,total_amount:u},{status:"OVERDUE",count:c.length,total_amount:p}]}),r}),alert("Paiement annulÃ© localement ! (Serveur non disponible)")}}catch(s){alert(s.userMessage||"Ã‰chec de l'annulation du paiement")}finally{q(null)}},Re=async()=>{if($)return;const t=new Date().toISOString().slice(0,7),o=`Do you want to generate monthly bills for all active tenants for ${new Date().toLocaleString("en-US",{month:"long",year:"numeric"})} (${t})?`;if(window.confirm(o)){le(!0),v(null);try{console.log("ðŸ”„ Generating bills for all active tenants...");const r=await j.generateBillsForCurrentAdmin(t);if(console.log("âœ… Bills generation response:",r),r.data&&r.data.success){const l=r.data.data||r.data.statistics,n=`âœ… Successfully generated ${l.billsGenerated||0} bill(s)!
â­ï¸ ${l.billsSkipped||0} bill(s) already existed (skipped).
ðŸ“Š Total active tenants: ${l.totalTenants||0}`;alert(n),console.log("ðŸ”„ Refreshing bills and stats..."),await I(),await R(),console.log("âœ… Bills generated and data refreshed successfully!")}else throw new Error(r.data?.message||"Error generating bills")}catch(r){console.error("âŒ Error generating bills:",r);const l=r.response?.data?.message||r.message||"Unknown error occurred while generating bills";v(l),alert("Error generating bills: "+l)}finally{le(!1)}}},ke=async t=>{t.preventDefault(),me(!0),ie(!0);try{console.log("ðŸ”„ Creating bill with data:",E);const s=await j.createBill({...E,status:"PENDING"});console.log("âœ… Bill creation response:",s),de(!0),await new Promise(g=>setTimeout(g,800)),K(!1),P({tenant_id:0,property_id:0,amount:0,charges:0,month:new Date().toISOString().slice(0,7),payment_date:"",description:"Monthly rent payment"}),console.log("â³ Waiting for database to update..."),await new Promise(g=>setTimeout(g,1e3)),console.log("ðŸ”„ Refreshing bills and stats..."),await I(),await R(),console.log("âœ… Bill created and data refreshed successfully!");const o=document.createElement("div");o.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg notification-enter z-50";const r=document.createElement("div");r.className="flex items-center gap-2";const l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttribute("class","w-5 h-5"),l.setAttribute("fill","currentColor"),l.setAttribute("viewBox","0 0 20 20");const n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("fill-rule","evenodd"),n.setAttribute("d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"),n.setAttribute("clip-rule","evenodd"),l.appendChild(n);const c=document.createElement("span");c.className="font-medium",c.textContent="Facture crÃ©Ã©e avec succÃ¨s !",r.appendChild(l),r.appendChild(c),o.appendChild(r),document.body.appendChild(o),setTimeout(()=>{o.remove()},3e3)}catch(s){console.error("âŒ Error creating bill:",s),ce(!0),setTimeout(()=>{ce(!1)},1e3),alert("Erreur lors de la crÃ©ation de la facture: "+(s.userMessage||s.message||"Erreur inconnue"))}finally{me(!1),ie(!1),de(!1)}},ye=(t,s)=>{we(o=>({...o,[t]:s,page:1}))},Be=async()=>{console.log("ðŸ”„ Manual refresh triggered");try{B(!0),v(null),O.clearCache(),await Promise.all([I(!0),R(),ue(),pe()]),console.log("âœ… Manual refresh completed - All data reloaded")}catch(t){console.error("âŒ Error during manual refresh:",t),v("Erreur lors du rafraÃ®chissement des donnÃ©es")}finally{B(!1)}},fe=t=>{switch(t){case"PENDING":return e.jsx(G,{className:"w-4 h-4 text-yellow-500"});case"PAID":return e.jsx(J,{className:"w-4 h-4 text-green-500"});case"OVERDUE":return e.jsx(ae,{className:"w-4 h-4 text-red-500"});case"RECEIPT_SENT":return e.jsx(J,{className:"w-4 h-4 text-blue-500"});default:return e.jsx(M,{className:"w-4 h-4 text-gray-500"})}},xe=t=>{switch(t){case"PENDING":return"bg-yellow-100 text-yellow-800";case"PAID":return"bg-green-100 text-green-800";case"OVERDUE":return"bg-red-100 text-red-800";case"RECEIPT_SENT":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return V&&N.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center content-fade-in",children:[e.jsxs("div",{className:"nav-item-enter-delay-1",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:d("payments.title")}),e.jsx("p",{className:"text-gray-600 mt-1",children:d("payments.title")})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:Be,disabled:V,className:`bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 flex items-center gap-2 nav-transition nav-hover-lift nav-item-enter-delay-1 smooth-transition hover-lift glow-effect ${V?"opacity-75 cursor-not-allowed":""}`,title:d("common.loading"),children:[e.jsx(Ce,{className:`w-4 h-4 nav-icon-float smooth-transition ${V?"animate-spin":""}`}),d("common.loading")]}),D.length>0&&e.jsxs("button",{onClick:Se,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2 nav-transition nav-hover-lift nav-item-enter-delay-2",children:[e.jsx(te,{className:"w-4 h-4 nav-icon-float-delay"}),d("payments.table.download")," (",D.length,")"]}),e.jsxs("button",{onClick:Re,disabled:$,className:`bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 flex items-center gap-2 nav-transition nav-hover-lift nav-item-enter-delay-2 smooth-transition hover-lift glow-effect ${$?"opacity-75 cursor-not-allowed":""}`,title:"Generate monthly bills for all active tenants with one click",children:[e.jsx(Oe,{className:`w-4 h-4 nav-icon-float ${$?"animate-spin":""}`}),$?"Generating...":"Generate All Monthly Bills"]}),e.jsxs("button",{onClick:async()=>{console.log("ðŸš€ Opening create bill form...");const{tenants:t,properties:s}=await Ae();S(t),T(s),K(!0),t.length>0||s.length>0?console.log("âœ… Create bill form opened with data loaded"):console.log("âš ï¸ No data loaded - check console for details")},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2 nav-transition nav-hover-lift nav-item-enter-delay-3 smooth-transition hover-lift glow-effect",children:[e.jsx(_e,{className:"w-4 h-4 nav-icon-float"}),d("payments.create")]})]})]}),se&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"w-5 h-5 text-red-600 mr-2"}),e.jsx("p",{className:"text-red-600 font-medium",children:se})]}),e.jsx("button",{onClick:()=>v(null),className:"text-red-400 hover:text-red-600",children:e.jsx(M,{className:"w-4 h-4"})})]})}),A&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow smooth-transition hover-lift fade-in",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ve,{className:"w-8 h-8 text-blue-600 smooth-transition"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:d("payments.totalBills")}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:A.totalBills})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow smooth-transition hover-lift fade-in",style:{animationDelay:"0.1s"},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx($e,{className:"w-8 h-8 text-green-600 smooth-transition"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:d("payments.totalAmount")}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[A.totalAmount.toFixed(2),"â‚¬"]})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow smooth-transition hover-lift fade-in",style:{animationDelay:"0.2s"},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{className:"w-8 h-8 text-yellow-600 smooth-transition"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:A.pendingBills})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow smooth-transition hover-lift fade-in",style:{animationDelay:"0.3s"},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"w-8 h-8 text-red-600 smooth-transition"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overdue"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:A.overdueBills})]})]})})]}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow smooth-transition hover-lift fade-in",style:{animationDelay:"0.4s"},children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4 text-gray-500"}),e.jsxs("select",{value:U.status,onChange:t=>ye("status",t.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm smooth-transition hover-lift focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"PAID",children:"Paid"}),e.jsx("option",{value:"OVERDUE",children:"Overdue"}),e.jsx("option",{value:"RECEIPT_SENT",children:"Receipt Sent"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("input",{type:"text",placeholder:"Search bills...",value:U.search,onChange:t=>ye("search",t.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm w-64"})})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden smooth-transition hover-lift fade-in",style:{animationDelay:"0.5s"},children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.jsx("input",{type:"checkbox",checked:D.length===N.length&&N.length>0,onChange:Ie,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500",title:"SÃ©lectionner tout"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:d("payments.table.tenant")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:d("payments.table.property")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:d("payments.table.amount")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:d("payments.table.month")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:d("payments.create.paymentDate")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:d("payments.table.status")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:d("payments.table.actions")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map((t,s)=>e.jsxs("tr",{className:"hover:bg-gray-50 smooth-transition hover-lift fade-in",style:{animationDelay:`${s*.1}s`},children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",checked:D.includes(t.id),onChange:()=>Te(t.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500",title:"SÃ©lectionner pour tÃ©lÃ©chargement"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.tenant?.name||t.tenant?.fullName||(t.tenant?.firstName&&t.tenant?.lastName?`${t.tenant.firstName} ${t.tenant.lastName}`:null)||(t.tenant?`${d("payments.tenant")} ${t.tenant.id}`:null)||t.tenant_display_name||d("payments.tenant")}),e.jsx("div",{className:"text-sm text-gray-500",children:t.tenant?.email||"N/A"})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Me,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.property?.title||t.property?.name||d("payments.property")}),e.jsx("div",{className:"text-sm text-gray-500",children:t.property?.city||d("payments.nA")})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["â‚¬",(t.total_amount||t.amount).toFixed(2)]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.month}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.payment_date?new Date(t.payment_date).toLocaleDateString(_==="fr"?"fr-FR":"en-US"):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${xe(t.status)}`,children:[fe(t.status),e.jsx("span",{className:"ml-1",children:t.status==="PENDING"?d("payments.status.pending"):t.status==="PAID"?d("payments.status.paid"):t.status==="OVERDUE"?d("payments.status.overdue"):t.status==="RECEIPT_SENT"?d("payments.status.receipt_sent"):t.status})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>z(t),className:"text-blue-600 hover:text-blue-900 nav-transition nav-hover-scale smooth-transition hover-lift",title:d("payments.table.view"),children:e.jsx(Ge,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ee(t.id),disabled:H===t.id,className:"text-gray-600 hover:text-gray-900 disabled:opacity-50 nav-transition nav-hover-scale smooth-transition hover-lift",title:d("payments.table.download"),children:H===t.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600"}):e.jsx(te,{className:"w-4 h-4"})}),(t.status==="PENDING"||t.status==="OVERDUE")&&e.jsx("button",{onClick:()=>he(t.id),disabled:b===t.id,className:"text-green-600 hover:text-green-900 disabled:opacity-50 nav-transition nav-hover-scale smooth-transition hover-lift",title:d("payments.table.markPaid"),children:b===t.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600"}):e.jsx(J,{className:"w-4 h-4"})}),t.status==="PAID"&&e.jsx("button",{onClick:()=>ge(t.id),disabled:b===t.id,className:"text-orange-600 hover:text-orange-900 disabled:opacity-50 nav-transition nav-hover-scale smooth-transition hover-lift",title:d("payments.table.undoPayment"),children:b===t.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-orange-600"}):e.jsx(M,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Pe(t.id),disabled:re===t.id,className:"text-red-600 hover:text-red-900 disabled:opacity-50 nav-transition nav-hover-scale smooth-transition hover-lift",title:"Supprimer la facture",children:re===t.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):e.jsx(ze,{className:"w-4 h-4"})})]})})]},t.id))})]})}),!1]}),ve&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 fade-in",children:e.jsx("div",{className:`relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white modal-enter ${Ee?"glow-effect":""} ${be?"error-shake":""}`,children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Create New Bill"}),e.jsxs("form",{onSubmit:ke,className:"space-y-4",children:[e.jsxs("div",{className:"slide-in-left",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tenant"}),e.jsxs("select",{value:E.tenant_id,onChange:t=>P(s=>({...s,tenant_id:parseInt(t.target.value)})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 smooth-transition hover-lift focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:0,children:"SÃ©lectionner un locataire"}),Array.isArray(W)&&W.length>0?W.map(t=>e.jsx("option",{value:t.id,children:t.display_name||t.name||t.fullName||`Locataire ${t.id}`},t.id)):e.jsx("option",{disabled:!0,children:"Aucun locataire disponible"})]})]}),e.jsxs("div",{className:"slide-in-right",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Property"}),e.jsxs("select",{value:E.property_id,onChange:t=>P(s=>({...s,property_id:parseInt(t.target.value)})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 smooth-transition hover-lift focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:0,children:"SÃ©lectionner une propriÃ©tÃ©"}),Array.isArray(L)&&L.length>0?L.map(t=>e.jsx("option",{value:t.id,children:t.display_name||t.title||t.name||`PropriÃ©tÃ© ${t.id}`},t.id)):e.jsx("option",{disabled:!0,children:"Aucune propriÃ©tÃ© disponible"})]})]}),e.jsxs("div",{className:"slide-in-left",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount"}),e.jsx("input",{type:"number",step:"0.01",value:E.amount,onChange:t=>P(s=>({...s,amount:parseFloat(t.target.value)})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 smooth-transition hover-lift focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"slide-in-right",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Charges Amount"}),e.jsx("input",{type:"number",step:"0.01",value:E.charges||0,onChange:t=>P(s=>({...s,charges:parseFloat(t.target.value)||0})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 smooth-transition hover-lift focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Optional"})]}),e.jsxs("div",{className:"slide-in-left",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Month"}),e.jsx("input",{type:"month",value:E.month,onChange:t=>P(s=>({...s,month:t.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 smooth-transition hover-lift focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"slide-in-right",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Date"}),e.jsx("input",{type:"date",value:E.payment_date||"",onChange:t=>P(s=>({...s,payment_date:t.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 smooth-transition hover-lift focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Optional"})]}),e.jsxs("div",{className:"slide-in-left",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{value:E.description,onChange:t=>P(s=>({...s,description:t.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 smooth-transition hover-lift focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>K(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 smooth-transition hover-lift",children:"Annuler"}),e.jsx("button",{type:"submit",disabled:Y,className:`px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 smooth-transition hover-lift ${Y?"opacity-50 cursor-not-allowed":""} ${je?"success-bounce":""}`,children:Y?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full loading-spinner"}),e.jsx("span",{children:"CrÃ©ation..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4"}),e.jsx("span",{children:"CrÃ©er la Facture"})]})})]})]})]})})}),m&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 fade-in",children:e.jsx("div",{className:"relative top-10 mx-auto p-0 border w-full max-w-2xl shadow-lg rounded-md bg-white modal-enter",children:e.jsxs("div",{className:"mt-0",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6 rounded-t-md",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"QUITTANCE DE LOYER"}),e.jsx("p",{className:"text-blue-100 text-sm",children:"ReÃ§u de paiement de loyer"})]}),e.jsx("button",{onClick:()=>z(null),className:"text-white hover:text-blue-200 transition-colors smooth-transition hover-lift",children:e.jsx(M,{className:"w-6 h-6"})})]})}),e.jsxs("div",{className:"p-6 bg-white",children:[e.jsx("div",{className:"border-b border-gray-200 pb-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:F().name}),e.jsx("p",{className:"text-sm text-gray-600",children:F().company}),e.jsx("p",{className:"text-sm text-gray-600",children:F().address}),e.jsxs("p",{className:"text-sm text-gray-600",children:[F().postalCode," ",F().city,", ",F().country]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:d("payments.preview.tenant")}),e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:m.tenant?.name||m.tenant?.fullName||(m.tenant?.firstName&&m.tenant?.lastName?`${m.tenant.firstName} ${m.tenant.lastName}`:null)||(m.tenant?`${d("payments.tenant")} ${m.tenant.id}`:null)||m.tenant_display_name||d("payments.nonRenseigne")}),e.jsx("p",{className:"text-sm text-gray-600",children:m.tenant?.email||d("payments.nonRenseigne")}),e.jsx("p",{className:"text-sm text-gray-600",children:m.tenant?.phone||d("payments.nonRenseigne")})]})]})}),e.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:d("payments.preview.property")}),e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:m.property?.title||m.property?.name||d("payments.property")}),e.jsx("p",{className:"text-sm text-gray-600",children:m.property?.address||d("payments.nA")}),e.jsx("p",{className:"text-sm text-gray-600",children:m.property?.city||d("payments.nA")})]}),e.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"DÃ©tail du rÃ¨glement :"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-gray-700",children:[d("payments.preview.rent")," :"]}),e.jsxs("span",{className:"font-semibold text-gray-900",children:["â‚¬",(m.rent_amount||m.amount).toFixed(2)," euros"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700",children:"(le cas Ã©chÃ©ant, contribution aux Ã©conomies d'Ã©nergies) :"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:["â‚¬",(m.charges||0).toFixed(2)," euros"]})]}),e.jsx("div",{className:"border-t border-gray-300 pt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[d("payments.preview.total")," :"]}),e.jsxs("span",{className:"text-xl font-bold text-blue-600",children:["â‚¬",(m.total_amount||m.amount).toFixed(2)," euros"]})]})})]})})]}),e.jsx("div",{className:"border-b border-gray-200 pb-4 mb-6",children:e.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-gray-700 font-medium",children:[d("payments.preview.paymentDate")," :"]}),e.jsx("span",{className:"text-lg font-bold text-green-600",children:m.payment_date?`Fait Ã  Paris, le ${qe(m.payment_date)}`:"Fait Ã  Paris, le ...... / ...... / 20......"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"PÃ©riode"}),e.jsx("p",{className:"text-blue-800",children:m.month})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Statut"}),e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${xe(m.status)}`,children:[fe(m.status),e.jsx("span",{className:"ml-2",children:m.status.replace("_"," ")})]})]})]}),m.description&&e.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-600",children:m.description})]}),e.jsxs("div",{className:"text-center text-xs text-gray-500 border-t border-gray-200 pt-4",children:[e.jsx("p",{children:"Ce reÃ§u fait foi de paiement du loyer pour la pÃ©riode indiquÃ©e."}),e.jsxs("p",{className:"mt-1",children:["GÃ©nÃ©rÃ© le ",new Date().toLocaleDateString("fr-FR")," Ã  ",new Date().toLocaleTimeString("fr-FR")]})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[(m.status==="PENDING"||m.status==="OVERDUE")&&e.jsx("button",{onClick:()=>{he(m.id),z(null)},disabled:b===m.id,className:"flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors smooth-transition hover-lift",children:b===m.id?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-4 h-4 mr-2 animate-spin"}),"Marquage en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Marquer comme payÃ©e"]})}),m.status==="PAID"&&e.jsx("button",{onClick:()=>{ge(m.id),z(null)},disabled:b===m.id,className:"flex items-center justify-center px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors smooth-transition hover-lift",children:b===m.id?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-4 h-4 mr-2 animate-spin"}),"Annulation en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Annuler le paiement"]})}),e.jsx("button",{onClick:()=>ee(m.id),disabled:H===m.id,className:"flex items-center justify-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors smooth-transition hover-lift",children:H===m.id?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-4 h-4 mr-2 animate-spin"}),"TÃ©lÃ©chargement en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"ðŸ“„ TÃ©lÃ©charger la Quittance PDF"]})})]})})]})]})})})]})};export{st as default};
