import{j as e}from"./index-BRkigiy4.js";import{r as o}from"./router-DUq0sin2.js";import k from"./api-DQwSXtBv.js";import{X as q,v as ge,F as ae,w as he,P as fe,s as be,x as L,y as se,z as ye,A as je}from"./icons-ByKMif1I.js";import"./Dashboard-Dh4ppiET.js";/* empty css                            */import"./vendor-Bzgz95E1.js";import"./utils-B9HHbEsj.js";import"./charts-DdKZH6bc.js";const Ne=({tenantId:h,tenantName:B,onClose:$})=>{const[j,X]=o.useState([]),[G,I]=o.useState(!1),[n,g]=o.useState(!1),[S,f]=o.useState(""),[m,N]=o.useState(null),[b,E]=o.useState("General"),[v,C]=o.useState(null),[T,y]=o.useState(""),O=["General","ID Document","Passport","Lease Agreement","Proof of Income","Bank Statement","Reference Letter","Other"];o.useEffect(()=>{w()},[h]);const w=async()=>{try{I(!0);const a=await k.getTenantDocuments(h);X(a.data?.data?.documents||[])}catch(a){console.error("Error fetching documents:",a),f(a.userMessage||"Failed to fetch documents")}finally{I(!1)}},J=a=>{const d=a.target.files;d&&d.length>0&&N(d)},D=async()=>{if(!m||m.length===0){f("Please select at least one document");return}g(!0),f("");try{const a=new FormData;for(let P=0;P<m.length;P++)a.append("documents",m[P]);a.append("document_type",b),await k.uploadTenantDocuments(h,a),N(null),E("General"),await w();const d=document.getElementById("document-upload");d&&(d.value="")}catch(a){console.error("Error uploading documents:",a),f(a.userMessage||"Failed to upload documents")}finally{g(!1)}},M=async a=>{if(confirm("Are you sure you want to delete this document?"))try{await k.deleteTenantDocument(h,a),await w()}catch(d){console.error("Error deleting document:",d),f(d.userMessage||"Failed to delete document")}},_=a=>{C(a.id),y(a.document_type)},i=async a=>{try{await k.updateTenantDocumentType(h,a,T),C(null),y(""),await w()}catch(d){console.error("Error updating document type:",d),f(d.userMessage||"Failed to update document type")}},p=()=>{C(null),y("")},A=()=>{N(null);const a=document.getElementById("document-upload");a&&(a.value="")},z=a=>a<1024?a+" B":a<1024*1024?(a/1024).toFixed(1)+" KB":(a/(1024*1024)).toFixed(1)+" MB",F=a=>a.startsWith("image/")?"üñºÔ∏è":a==="application/pdf"?"üìÑ":a.includes("word")?"üìù":a.includes("excel")||a.includes("spreadsheet")?"üìä":"üìé";return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white z-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Tenant Documents"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:B})]}),e.jsx("button",{onClick:$,className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Close",children:e.jsx(q,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Upload New Documents"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsxs("label",{htmlFor:"document-upload",className:"flex items-center justify-center w-full px-4 py-3 border border-gray-300 rounded-lg cursor-pointer bg-white hover:bg-gray-100 transition-colors",children:[e.jsx(ge,{className:"w-5 h-5 mr-2 text-gray-600"}),e.jsx("span",{className:"text-gray-700",children:"Choose Files"}),e.jsx("input",{id:"document-upload",type:"file",multiple:!0,onChange:J,className:"hidden",accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx,.txt"})]})}),e.jsx("div",{children:e.jsx("select",{value:b,onChange:a=>E(a.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:O.map(a=>e.jsx("option",{value:a,children:a},a))})})]}),m&&m.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[m.length," file(s) selected"]}),e.jsx("button",{onClick:A,className:"text-sm text-red-600 hover:text-red-800",children:"Clear Selection"})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-3 max-h-32 overflow-y-auto",children:Array.from(m).map((a,d)=>e.jsxs("div",{className:"flex items-center justify-between py-1 text-sm",children:[e.jsx("span",{className:"text-gray-700 truncate flex-1",children:a.name}),e.jsx("span",{className:"text-gray-500 ml-2",children:z(a.size)})]},d))}),e.jsx("button",{onClick:D,disabled:n,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:n?"Uploading...":"Upload Documents"})]})]})]}),S&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:S}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Uploaded Documents (",j.length,")"]}),G?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading documents..."})]}):j.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(ae,{className:"w-12 h-12 mx-auto text-gray-400 mb-3"}),e.jsx("p",{className:"text-gray-600",children:"No documents uploaded yet"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Upload your first document above"})]}):e.jsx("div",{className:"space-y-3",children:j.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg bg-white hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[e.jsx("div",{className:"text-3xl mr-3",children:F(a.mime_type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",title:a.original_filename,children:a.original_filename}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[v===a.id?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("select",{value:T,onChange:d=>y(d.target.value),className:"text-xs px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",children:O.map(d=>e.jsx("option",{value:d,children:d},d))}),e.jsx("button",{onClick:()=>i(a.id),className:"text-green-600 hover:text-green-800",title:"Save",children:e.jsx(he,{className:"w-4 h-4"})}),e.jsx("button",{onClick:p,className:"text-gray-600 hover:text-gray-800",title:"Cancel",children:e.jsx(q,{className:"w-4 h-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:a.document_type}),e.jsx("button",{onClick:()=>_(a),className:"text-gray-400 hover:text-gray-600",title:"Edit type",children:e.jsx(fe,{className:"w-3 h-3"})})]}),e.jsx("span",{className:"text-xs text-gray-500",children:z(a.file_size)})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("a",{href:a.file_url,target:"_blank",rel:"noopener noreferrer",download:!0,className:"flex items-center justify-center px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded hover:bg-blue-100 transition-colors",title:"Download",children:e.jsx(be,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>M(a.id),className:"flex items-center justify-center px-3 py-2 text-sm bg-red-50 text-red-700 rounded hover:bg-red-100 transition-colors",title:"Delete",children:e.jsx(L,{className:"w-4 h-4"})})]})]},a.id))})]})]}),e.jsx("div",{className:"flex items-center justify-end p-6 border-t border-gray-200 bg-gray-50",children:e.jsx("button",{onClick:$,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Close"})})]})})},Y=k,Ae=()=>{const h=t=>{if(!t)return"active";const s=t.toUpperCase();return s==="ACTIVE"?"active":s==="INACTIVE"?"inactive":s==="EXPIRED"?"expired":"active"},B=t=>{const s=h(t);return s==="active"?"Actif":s==="inactive"?"Inactif":s==="expired"?"Expir√©":"N/A"},$=t=>{const s=h(t);return s==="active"?"bg-green-100 text-green-800":s==="inactive"?"bg-yellow-100 text-yellow-800":s==="expired"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"},[j,X]=o.useState(""),[G,I]=o.useState(!1),[n,g]=o.useState({fullName:"",email:"",phone:"",address:"",propertyId:"",checkInDate:"",checkOutDate:"",documents:[],rent:"",charges:"",status:"ACTIVE"}),[S,f]=o.useState([]),[m,N]=o.useState([]),[b,E]=o.useState(!1),[v,C]=o.useState(null),[T,y]=o.useState(!1),[O,w]=o.useState(null),[J,D]=o.useState(!1),[M,_]=o.useState(null),[i,p]=o.useState({fullName:"",email:"",phone:"",address:"",propertyId:"",checkInDate:"",checkOutDate:"",documents:[],rent:"",charges:"",status:"ACTIVE"}),[A,z]=o.useState(null),[F,a]=o.useState({isOpen:!1,tenantId:null,tenantName:""}),[d,P]=o.useState(!1),[R,ve]=o.useState(new Set),re=async()=>{E(!0),C(null);try{if(!localStorage.getItem("token")){console.log("No token found, skipping properties API call"),N([]),E(!1);return}const s=await k.listProperties();if(console.log("üìä Properties API response:",s.data),s.data?.success&&s.data?.data?.properties){const l=s.data.data.properties.map(c=>({id:c.id,title:c.title,monthly_rent:c.monthly_rent||0}));N(l)}else C("Failed to load properties"),N([]),console.log("‚ùå Failed to load properties - invalid response structure")}catch(t){console.error("‚ùå Error fetching properties:",t),C(t.response?.data?.error||"Failed to load properties"),N([])}finally{E(!1)}},U=async(t=!0,s="unknown")=>{if(t&&R.size>0){console.log(`‚è∏Ô∏è Skipping fetchTenants (reason: ${s}) - status update in progress for:`,Array.from(R));return}console.log(`üîÑ fetchTenants called (reason: ${s}), isUpdatingStatus.size: ${R.size}`),y(!0),w(null);try{if(!localStorage.getItem("token")){console.log("No token found, skipping tenants API call"),f([]),y(!1);return}const c=JSON.parse(localStorage.getItem("user")||"{}");console.log("üë§ Current user:",c),console.log("üÜî User admin_id:",c.id),console.log("üë§ User role:",c.role);const u=await k.listTenants();console.log("üìä Tenant API response:",u.data),console.log("üìä Response success:",u.data?.success),console.log("üìä Response data structure:",u.data?.data),console.log("üìä Tenants array:",u.data?.data?.tenants),console.log("üìä Tenants count:",u.data?.data?.tenants?.length);const x=u.data?.data?.tenants||[];console.log("üìã Raw tenant data:",x),console.log("üìã Raw tenant data length:",x.length),console.log("üìã Raw tenant statuses:",x.map(r=>({id:r.id,name:r.name,status:r.status}))),console.log("üìã Raw tenant phones:",x.map(r=>({id:r.id,name:r.name,phone:r.phone,phone_number:r.phone_number})));const K={};x.forEach(r=>{const V=r.status?.toUpperCase()||"ACTIVE";r.property_id&&V==="ACTIVE"&&(K[r.property_id]=(K[r.property_id]||0)+1)});const ee=x.map(r=>{const V=r.property,te=m.find(xe=>xe.id===r.property_id),ue=V?.title||V?.name||te?.title||(r.property_id?`Propri√©t√© #${r.property_id}`:"Aucune propri√©t√©"),W=V?.monthly_rent||V?.rent||te?.monthly_rent||0,H=K[r.property_id]||1,me=H>0?W/H:W,Q=r.status?.toUpperCase()||"ACTIVE",pe=Q==="ACTIVE"?"active":Q==="INACTIVE"?"inactive":Q==="EXPIRED"?"expired":"active";return{id:String(r.id),fullName:r.name,email:r.email||"",phone:r.phone||r.phone_number||r.phoneNumber||"",propertyName:ue,propertyId:r.property_id?String(r.property_id):"",checkInDate:r.lease_start||"",checkOutDate:r.lease_end||"",stayDuration:0,status:pe,avatar:"",documents:[],rent_amount:r.rent_amount||null,charges_amount:r.charges_amount||null,property_monthly_rent:W,tenants_count:H,divided_rent:me,document_path:r.documents}});console.log(`‚úÖ Setting tenants state (reason: ${s}), mapped statuses:`,ee.map(r=>({id:r.id,name:r.fullName,status:r.status}))),f(ee)}catch(l){console.error("‚ùå Error loading tenants:",l),w(l.response?.data?.error||l.message||"Failed to load tenants"),f([])}finally{y(!1)}};o.useEffect(()=>{(async()=>{await re(),await U(!0,"component-mount")})()},[]),o.useEffect(()=>(m.length>0&&S.length===0&&R.size===0&&U(!0,"properties-changed"),()=>{y(!1),w(null)}),[m,R.size]);const ne=async t=>{if(t.preventDefault(),console.log("üìù Tenant form submitted"),!n.fullName.trim()){console.log("‚ùå Validation failed: Name is required"),alert("Please enter tenant name");return}if(!n.email.trim()){console.log("‚ùå Validation failed: Email is required"),alert("Please enter tenant email");return}if(!n.propertyId){console.log("‚ùå Validation failed: Property is required"),alert("Please select a property");return}const s=parseInt(n.propertyId);if(isNaN(s)){console.log("‚ùå Validation failed: Invalid property ID"),alert("Invalid property selected");return}const l={name:n.fullName.trim(),email:n.email.trim(),property_id:s};l.status=n.status&&n.status.trim()||"ACTIVE",n.phone?.trim()&&(l.phone=n.phone.trim()),n.address?.trim()&&(l.address=n.address.trim()),n.rent&&(l.rent_amount=parseFloat(n.rent)),n.charges&&(l.charges_amount=parseFloat(n.charges)),n.checkInDate&&(l.lease_start=n.checkInDate),n.checkOutDate&&(l.lease_end=n.checkOutDate),l.status&&(l.status=l.status.toUpperCase().trim()),console.log("üì§ Sending tenant data:",JSON.stringify(l,null,2));try{const c=await Y.createTenant(l);console.log("‚úÖ Tenant created successfully:",c.data),I(!1),g({fullName:"",email:"",phone:"",address:"",propertyId:"",checkInDate:"",checkOutDate:"",documents:[],rent:"",charges:"",status:"ACTIVE"}),console.log("üîÑ Refreshing tenant list after creation..."),await U(!0,"after-tenant-creation")}catch(c){console.error("‚ùå Create tenant error:",c);let u=c?.response?.data?.error||c?.message||"Failed to add tenant. Please try again.";u.includes("Too many requests")&&(u="Rate limit exceeded. Please wait a moment before trying again.");const x=c?.response?.data?.details;x?(console.error("üìã Validation details:",x),alert(`${u}

Details: ${JSON.stringify(x,null,2)}`)):alert(u)}},le=t=>{console.log("‚úèÔ∏è Editing tenant:",t),_(t),p({fullName:t.fullName||"",email:t.email||"",phone:t.phone||"",address:t.address||"",propertyId:t.propertyId||"",checkInDate:t.checkInDate||"",checkOutDate:t.checkOutDate||"",documents:[],rent:t.rent_amount?String(t.rent_amount):"",charges:t.charges_amount?String(t.charges_amount):"",status:t.status?.toUpperCase()||"ACTIVE"}),D(!0)},oe=t=>{a({isOpen:!0,tenantId:String(t.id),tenantName:t.fullName||t.name||"this tenant"})},ie=async()=>{if(F.tenantId){P(!0);try{await Y.deleteTenantApi(F.tenantId),console.log("‚úÖ Tenant deleted successfully"),a({isOpen:!1,tenantId:null,tenantName:""}),await U(!0,"after-tenant-deletion")}catch(t){console.error("‚ùå Error deleting tenant:",t);let s=t?.response?.data?.error||t?.message||"Failed to delete tenant. Please try again.";s.includes("Too many requests")&&(s="Rate limit exceeded. Please wait a moment before trying again."),alert(s)}finally{P(!1)}}},de=()=>{a({isOpen:!1,tenantId:null,tenantName:""})},ce=async t=>{if(t.preventDefault(),!M)return;if(console.log("üìù Edit tenant form submitted"),!i.fullName.trim()){alert("Please enter tenant name");return}if(!i.email.trim()){alert("Please enter tenant email");return}if(!i.propertyId){alert("Please select a property");return}const s=parseInt(i.propertyId);if(isNaN(s)){alert("Invalid property selected");return}const l={name:i.fullName.trim(),email:i.email.trim(),property_id:s};i.phone?.trim()&&(l.phone=i.phone.trim()),i.address?.trim()&&(l.address=i.address.trim()),i.rent&&(l.rent_amount=parseFloat(i.rent)),i.charges&&(l.charges_amount=parseFloat(i.charges)),i.status&&(l.status=i.status),console.log("üì§ Updating tenant data:",l);try{const c=await Y.updateTenant(M.id,l);console.log("‚úÖ Tenant updated successfully:",c.data),D(!1),_(null),p({fullName:"",email:"",phone:"",address:"",propertyId:"",checkInDate:"",checkOutDate:"",documents:[],rent:"",charges:"",status:"ACTIVE"}),console.log("üîÑ Refreshing tenant list after update..."),await U(!0,"after-tenant-edit")}catch(c){console.error("‚ùå Update tenant error:",c);let u=c?.response?.data?.error||c?.message||"Failed to update tenant. Please try again.";u.includes("Too many requests")&&(u="Rate limit exceeded. Please wait a moment before trying again.");const x=c?.response?.data?.details;x?(console.error("üìã Validation details:",x),alert(`${u}

Details: ${JSON.stringify(x,null,2)}`)):alert(u)}},Z=S.filter(t=>t.fullName?.toLowerCase().includes(j.toLowerCase())||t.propertyName?.toLowerCase().includes(j.toLowerCase())||t.propertyId?.toLowerCase().includes(j.toLowerCase()));return e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 fade-in-soft",children:"Tenant Management"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"p-3 bg-blue-50 rounded smooth-transition hover-lift fade-in",style:{animationDelay:"0.1s"},children:[e.jsx("h3",{className:"font-semibold",children:"Properties Status:"}),b?e.jsx("p",{className:"shimmer",children:"Loading properties..."}):v?e.jsxs("p",{className:"text-red-600",children:["Error: ",v]}):e.jsxs("p",{className:"text-green-600",children:["‚úì Found ",m.length," properties"]})]}),e.jsxs("div",{className:"p-3 bg-green-50 rounded smooth-transition hover-lift fade-in",style:{animationDelay:"0.2s"},children:[e.jsx("h3",{className:"font-semibold",children:"Tenants Status:"}),T?e.jsx("p",{className:"shimmer",children:"Loading tenants..."}):O?e.jsxs("p",{className:"text-red-600",children:["Error: ",O]}):e.jsxs("p",{className:"text-green-600",children:["‚úì Found ",S.length," tenants"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-3 md:gap-4 mb-4 md:mb-6",children:[e.jsx("div",{className:"flex-1 w-full sm:max-w-md slide-in-left",children:e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 smooth-transition"}),e.jsx("input",{type:"text",placeholder:"Rechercher des locataires...",value:j,onChange:t=>X(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 smooth-transition hover-lift text-sm md:text-base"})]})}),e.jsxs("button",{onClick:()=>I(!0),className:"flex items-center justify-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 smooth-transition hover-lift-strong glow-effect slide-in-right w-full sm:w-auto",children:[e.jsx(ye,{className:"w-4 h-4 smooth-transition"}),e.jsx("span",{className:"text-sm md:text-base",children:"Ajouter un locataire"})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:Z.map((t,s)=>e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden smooth-transition hover-lift fade-in",style:{animationDelay:`${s*.1}s`},children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-semibold",children:t.fullName?.charAt(0)||"T"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.fullName}),e.jsx("p",{className:"text-sm text-gray-500",children:t.email})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>z(t),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg nav-transition nav-hover-scale",title:"G√©rer les documents",children:e.jsx(ae,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>le(t),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg nav-transition nav-hover-scale",title:"Modifier le locataire",children:e.jsx(je,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>oe(t),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg nav-transition nav-hover-scale hover:text-red-700",title:"Supprimer le locataire",children:e.jsx(L,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-1.5 text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Propri√©t√©:"})," ",t.propertyName||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"T√©l√©phone:"})," ",t.phone&&t.phone.trim()?t.phone:"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Loyer:"}),t.rent_amount!==void 0&&t.rent_amount!==null&&Number(t.rent_amount)>0?e.jsxs("span",{className:"font-semibold text-blue-600",children:["‚Ç¨",Number(t.rent_amount).toFixed(2)]}):t.divided_rent!==void 0&&t.divided_rent!==null&&Number(t.divided_rent)>0?e.jsxs("span",{children:[e.jsxs("span",{className:"font-semibold text-blue-600",children:["‚Ç¨",Number(t.divided_rent).toFixed(2)]}),t.tenants_count&&t.tenants_count>1&&e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(partag√© sur ",t.tenants_count," locataires)"]})]}):e.jsx("span",{className:"text-gray-400",children:"N/A"})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Charges:"}),t.charges_amount!==void 0&&t.charges_amount!==null&&Number(t.charges_amount)>0?e.jsxs("span",{className:"font-semibold text-green-600",children:["‚Ç¨",Number(t.charges_amount).toFixed(2)]}):e.jsx("span",{className:"text-gray-400",children:"N/A"})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Statut:"}),e.jsx("span",{className:`ml-1 px-2 py-1 rounded-full text-xs ${$(t.status)}`,children:B(t.status)},`status-badge-${t.id}-${h(t.status)}`)]})})]})]})},`tenant-${t.id}-${h(t.status)}-${s}`))}),Z.length===0&&!T&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-2",children:e.jsx(se,{className:"w-12 h-12 mx-auto"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"Aucun locataire trouv√©"}),e.jsx("p",{className:"text-gray-600",children:"Essayez d'ajuster vos termes de recherche ou ajoutez un nouveau locataire."})]}),T&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-blue-400 mb-2",children:e.jsx("div",{className:"w-12 h-12 mx-auto border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"Chargement des locataires..."}),e.jsx("p",{className:"text-gray-600",children:"Veuillez patienter pendant que nous r√©cup√©rons les donn√©es des locataires."})]}),G&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 sticky top-0 bg-white pb-2 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg md:text-xl font-semibold",children:"Ajouter un nouveau locataire"}),e.jsx("button",{onClick:()=>I(!1),className:"text-gray-400 hover:text-gray-600 p-1","aria-label":"Fermer",children:e.jsx(q,{className:"w-5 h-5 md:w-6 md:h-6"})})]}),e.jsxs("form",{onSubmit:ne,className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom complet *"}),e.jsx("input",{type:"text",required:!0,value:n.fullName,onChange:t=>g(s=>({...s,fullName:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",required:!0,value:n.email,onChange:t=>g(s=>({...s,email:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T√©l√©phone"}),e.jsx("input",{type:"tel",value:n.phone,onChange:t=>g(s=>({...s,phone:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adresse"}),e.jsx("input",{type:"text",value:n.address,onChange:t=>g(s=>({...s,address:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Entrez l'adresse du locataire"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Propri√©t√© *"}),e.jsxs("select",{required:!0,value:n.propertyId,onChange:t=>g(s=>({...s,propertyId:t.target.value})),disabled:b,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${b?"bg-gray-100 cursor-not-allowed":""}`,children:[e.jsx("option",{value:"",children:b?"Chargement des propri√©t√©s...":"S√©lectionnez une propri√©t√©"}),m.map(t=>e.jsx("option",{value:String(t.id),children:t.title},t.id))]}),v&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:v})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Montant du loyer"}),e.jsx("input",{type:"number",step:"0.01",value:n.rent,onChange:t=>g(s=>({...s,rent:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Montant des charges"}),e.jsx("input",{type:"number",step:"0.01",value:n.charges,onChange:t=>g(s=>({...s,charges:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optionnel"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statut *"}),e.jsxs("select",{required:!0,value:n.status||"ACTIVE",onChange:t=>g(s=>({...s,status:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"ACTIVE",children:"Actif"}),e.jsx("option",{value:"INACTIVE",children:"Inactif"}),e.jsx("option",{value:"EXPIRED",children:"Expir√©"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>I(!1),className:"w-full sm:w-auto px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm md:text-base",children:"Annuler"}),e.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm md:text-base",children:"Ajouter le locataire"})]})]})]})}),A&&e.jsx(Ne,{tenantId:Number(A.id),tenantName:A.fullName||A.name||"Inconnu",onClose:()=>z(null)}),J&&M&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 sticky top-0 bg-white pb-2 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg md:text-xl font-semibold",children:"Modifier le locataire"}),e.jsx("button",{onClick:()=>{D(!1),_(null),p({fullName:"",email:"",phone:"",address:"",propertyId:"",checkInDate:"",checkOutDate:"",documents:[],rent:"",charges:"",status:"ACTIVE"})},className:"text-gray-400 hover:text-gray-600",children:e.jsx(q,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:ce,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom complet *"}),e.jsx("input",{type:"text",required:!0,value:i.fullName,onChange:t=>p(s=>({...s,fullName:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",required:!0,value:i.email,onChange:t=>p(s=>({...s,email:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T√©l√©phone"}),e.jsx("input",{type:"tel",value:i.phone,onChange:t=>p(s=>({...s,phone:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adresse"}),e.jsx("input",{type:"text",value:i.address,onChange:t=>p(s=>({...s,address:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Entrez l'adresse du locataire"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Propri√©t√© *"}),e.jsxs("select",{required:!0,value:i.propertyId,onChange:t=>p(s=>({...s,propertyId:t.target.value})),disabled:b,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${b?"bg-gray-100 cursor-not-allowed":""}`,children:[e.jsx("option",{value:"",children:b?"Chargement des propri√©t√©s...":"S√©lectionnez une propri√©t√©"}),m.map(t=>e.jsx("option",{value:String(t.id),children:t.title},t.id))]}),v&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:v})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Montant du loyer"}),e.jsx("input",{type:"number",step:"0.01",value:i.rent,onChange:t=>p(s=>({...s,rent:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Montant des charges"}),e.jsx("input",{type:"number",step:"0.01",value:i.charges,onChange:t=>p(s=>({...s,charges:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optionnel"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statut *"}),e.jsxs("select",{required:!0,value:i.status||"ACTIVE",onChange:t=>p(s=>({...s,status:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"ACTIVE",children:"Actif"}),e.jsx("option",{value:"INACTIVE",children:"Inactif"}),e.jsx("option",{value:"EXPIRED",children:"Expir√©"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>{D(!1),_(null),p({fullName:"",email:"",phone:"",address:"",propertyId:"",checkInDate:"",checkOutDate:"",documents:[],rent:"",charges:"",status:"ACTIVE"})},className:"w-full sm:w-auto px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm md:text-base",children:"Annuler"}),e.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm md:text-base",children:"Mettre √† jour le locataire"})]})]})]})}),F.isOpen&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 md:p-6 w-full max-w-md mx-4 shadow-xl",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 rounded-full",children:e.jsx(L,{className:"w-6 h-6 text-red-600"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 text-center mb-2",children:"Supprimer le locataire"}),e.jsxs("p",{className:"text-gray-600 text-center mb-6",children:["√ätes-vous s√ªr de vouloir supprimer ",e.jsx("strong",{children:F.tenantName})," ? Cette action est irr√©versible et toutes les donn√©es associ√©es seront supprim√©es."]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-3",children:[e.jsx("button",{onClick:de,disabled:d,className:"w-full sm:w-auto px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm md:text-base",children:"Annuler"}),e.jsx("button",{onClick:ie,disabled:d,className:"w-full sm:w-auto px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2 text-sm md:text-base",children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Suppression..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{children:"Supprimer"})]})})]})]})})]})};export{Ae as default};
