import{j as s}from"./index-rAghrxu1.js";import{r as i}from"./router-DUq0sin2.js";import{login as z}from"./api-XfUXylTc.js";import{H as N,U as R,L as T,E as D,a as M}from"./icons-B-WyEUkg.js";import"./vendor-Bzgz95E1.js";import"./utils-B9HHbEsj.js";const H=()=>{const[c,E]=i.useState(""),[u,S]=i.useState(""),[g,r]=i.useState(""),[m,b]=i.useState(!1),[w,v]=i.useState(""),[k,y]=i.useState(0),[j,p]=i.useState(0),[f,o]=i.useState(null),[h,C]=i.useState(!1),L=(n,e)=>{f===n&&(o(null),r("")),E(e)},I=async n=>{if(n.preventDefault(),!c.trim()){o("email"),r("L'email est requis");return}if(!c.includes("@")){o("email"),r("Veuillez entrer une adresse email valide");return}if(!u){o("password"),r("Le mot de passe est requis");return}if(u.length<6){o("password"),r("Le mot de passe doit contenir au moins 6 caractères");return}if(j>Date.now()){const e=Math.ceil((j-Date.now())/1e3);r(`Trop de tentatives. Veuillez attendre ${e} secondes.`);return}r(""),v(""),b(!0),o(null);try{const e=await z(c,u);if(!e||!e.data){console.error("Invalid response structure:",e),r("Réponse invalide du serveur");return}if(e.data.success&&e.data.data){const{token:l,admin:t}=e.data.data;if(!l){console.error("Token missing in response:",e.data),r("Token manquant dans la réponse du serveur");return}if(!t){console.error("Admin data missing in response:",e.data),r("Données utilisateur manquantes dans la réponse");return}localStorage.setItem("token",l),localStorage.setItem("user",JSON.stringify(t)),y(0),p(0),v("Connexion réussie ! Redirection..."),setTimeout(()=>{window.location.href="/dashboard"},1e3)}else console.error("Invalid response format:",e.data),r(e.data?.error||"Format de réponse invalide du serveur")}catch(e){if(console.error("Login error:",e),e.response?.status===429){const t=parseInt(e.response.headers["retry-after"]||"900");p(Date.now()+t*1e3),r(`Trop de tentatives de connexion. Veuillez réessayer dans ${Math.ceil(t/60)} minutes.`);return}if(e.response?.status===401){const t=e.response.data,x=t?.error||t?.message||"Email ou mot de passe incorrect";r(x);const d=k+1;if(y(d),d>=3){const a=Math.min(Math.pow(2,d-3)*1e3,3e4);p(Date.now()+a)}return}if(e.response?.status===400&&e.response?.data?.details&&Array.isArray(e.response.data.details)){const t=e.response.data.details.map(a=>a.msg||a.message||a).join(", ");r(`Erreur de validation: ${t}`);const x=e.response.data.details.find(a=>a.param==="email"||a.path==="email"||a.msg&&a.msg.toLowerCase().includes("email")),d=e.response.data.details.find(a=>a.param==="password"||a.path==="password"||a.msg&&a.msg.toLowerCase().includes("password"));x?o("email"):d&&o("password");return}if(e.response?.data?.code==="VALIDATION_ERROR"){o(e.response.data.field||null),r(e.response.data.error||e.response.data.message||"Erreur de validation");return}if(!e.response){r(e.message==="Network Error"?"Erreur réseau. Vérifiez votre connexion internet.":"Impossible de joindre le serveur. Vérifiez votre connexion.");return}let l="Échec de connexion. Veuillez réessayer.";e.response?.data?e.response.data.error?l=e.response.data.error:e.response.data.message?l=e.response.data.message:typeof e.response.data=="string"&&(l=e.response.data):e.message&&!e.message.includes("Network Error")&&(l=e.message),r(l)}finally{b(!1)}};return s.jsxs("div",{className:"min-h-screen flex",children:[s.jsxs("div",{className:"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-blue-600 to-indigo-700 relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-black opacity-10"}),s.jsx("div",{className:"absolute inset-0 bg-[url('https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=1600&h=900&fit=crop')] bg-cover bg-center opacity-20"}),s.jsxs("div",{className:"relative w-full flex flex-col items-center justify-center text-white p-12 animate-fade-in",children:[s.jsx("div",{className:"w-24 h-24 bg-white/10 backdrop-blur-lg rounded-3xl flex items-center justify-center mb-8 animate-float",children:s.jsx(N,{className:"w-12 h-12 text-white"})}),s.jsxs("h2",{className:"text-display-large mb-6 text-center",children:["Gestion Immobilière",s.jsx("br",{}),"Simplifiée"]}),s.jsx("p",{className:"text-body-large text-white/80 text-center max-w-md",children:"Votre plateforme complète de gestion immobilière pour la colocation et le partage de logement."})]})]}),s.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-8 bg-gray-50",children:s.jsxs("div",{className:"w-full max-w-md space-y-8 animate-fade-in-up",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"lg:hidden inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-2xl mb-6 animate-float",children:s.jsx(N,{className:"w-8 h-8 text-white"})}),s.jsx("h1",{className:"text-heading-large mb-3",children:"Bienvenue"}),s.jsx("p",{className:"text-body-medium text-gray-600",children:"Connectez-vous à votre tableau de bord"})]}),s.jsx("div",{className:"bg-white rounded-2xl shadow-lg shadow-gray-100/50 p-8 space-y-6 hover:shadow-xl transition-shadow duration-300",children:s.jsxs("form",{onSubmit:I,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"form-label mb-2",children:"Email"}),s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 transition-colors duration-200 group-focus-within:text-blue-500",children:s.jsx(R,{className:"w-full h-full"})}),s.jsx("input",{id:"email",type:"email",value:c,onChange:n=>L("email",n.target.value),className:`form-input w-full pl-12 pr-4 py-3 border rounded-xl bg-gray-50 focus:bg-white focus:ring-2 transition-all duration-200 ${f==="email"?"border-red-500 focus:ring-red-200 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-transparent"}`,placeholder:"Entrez votre email",required:!0,disabled:m,"aria-invalid":f==="email"?"true":"false","aria-describedby":"email-error"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"form-label mb-2",children:"Mot de passe"}),s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 transition-colors duration-200 group-focus-within:text-blue-500",children:s.jsx(T,{className:"w-full h-full"})}),s.jsx("input",{id:"password",type:h?"text":"password",value:u,onChange:n=>S(n.target.value),className:"form-input w-full pl-12 pr-4 py-3 border border-gray-300 rounded-xl bg-gray-50 focus:bg-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Entrez votre mot de passe",required:!0}),s.jsx("button",{type:"button",onClick:()=>C(n=>!n),"aria-label":h?"Masquer le mot de passe":"Afficher le mot de passe",className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:h?s.jsx(D,{className:"w-5 h-5"}):s.jsx(M,{className:"w-5 h-5"})})]})]}),g&&s.jsx("div",{className:"bg-red-50/50 border border-red-100 rounded-xl p-4 backdrop-blur-sm",children:s.jsx("p",{className:"text-red-600 text-body-small",children:g})}),w&&s.jsx("div",{className:"bg-green-50/50 border border-green-100 rounded-xl p-4 backdrop-blur-sm",children:s.jsx("p",{className:"text-green-700 text-body-small",children:w})}),s.jsx("button",{type:"submit",disabled:m,className:"btn-text w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white py-3 px-6 rounded-xl shadow-lg shadow-blue-500/20 hover:shadow-xl hover:shadow-blue-500/30 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Connexion...":"Se connecter"})]})}),s.jsx("div",{className:"text-center mt-8",children:s.jsx("p",{className:"text-body-small text-gray-500",children:"© 2025 HomeShare. Tous droits réservés."})})]})})]})};export{H as default};
