import{j as e}from"./index-BRkigiy4.js";import{r as a}from"./router-DUq0sin2.js";import{login as O}from"./api-DQwSXtBv.js";import{H as M,B as U,U as $,C as H,a as G,L as J,E as W,b as _,M as K}from"./icons-ByKMif1I.js";import"./vendor-Bzgz95E1.js";import"./utils-B9HHbEsj.js";const re=()=>{const[m,V]=a.useState(""),[x,I]=a.useState(""),[N,r]=a.useState(""),[f,E]=a.useState(!1),[S,k]=a.useState(""),[T,C]=a.useState(0),[L,g]=a.useState(0),[w,i]=a.useState(null),[v,q]=a.useState(!1),[D,h]=a.useState(!1),[j,p]=a.useState(""),[b,z]=a.useState(!1),[P,d]=a.useState(""),[F,c]=a.useState(""),R=(o,s)=>{w===o&&(i(null),r("")),V(s)},A=async o=>{if(o.preventDefault(),!m.trim()){i("email"),r("L'email est requis");return}if(!m.includes("@")){i("email"),r("Veuillez entrer une adresse email valide");return}if(!x){i("password"),r("Le mot de passe est requis");return}if(x.length<6){i("password"),r("Le mot de passe doit contenir au moins 6 caractères");return}if(L>Date.now()){const s=Math.ceil((L-Date.now())/1e3);r(`Trop de tentatives. Veuillez attendre ${s} secondes.`);return}r(""),k(""),E(!0),i(null);try{const s=await O(m,x);if(!s||!s.data){console.error("Invalid response structure:",s),r("Réponse invalide du serveur");return}if(s.data.success&&s.data.data){const{token:n,admin:l}=s.data.data;if(!n){console.error("Token missing in response:",s.data),r("Token manquant dans la réponse du serveur");return}if(!l){console.error("Admin data missing in response:",s.data),r("Données utilisateur manquantes dans la réponse");return}localStorage.setItem("token",n),localStorage.setItem("user",JSON.stringify(l)),C(0),g(0),k("Connexion réussie ! Redirection..."),setTimeout(()=>{window.location.href="/dashboard"},1e3)}else console.error("Invalid response format:",s.data),r(s.data?.error||"Format de réponse invalide du serveur")}catch(s){if(console.error("Login error:",s),s.response?.status===429){const l=parseInt(s.response.headers["retry-after"]||"900");g(Date.now()+l*1e3),r(`Trop de tentatives de connexion. Veuillez réessayer dans ${Math.ceil(l/60)} minutes.`);return}if(s.response?.status===401){const l=s.response.data,y=l?.error||l?.message||"Email ou mot de passe incorrect";r(y);const u=T+1;if(C(u),u>=3){const t=Math.min(Math.pow(2,u-3)*1e3,3e4);g(Date.now()+t)}return}if(s.response?.status===400&&s.response?.data?.details&&Array.isArray(s.response.data.details)){const l=s.response.data.details.map(t=>t.msg||t.message||t).join(", ");r(`Erreur de validation: ${l}`);const y=s.response.data.details.find(t=>t.param==="email"||t.path==="email"||t.msg&&t.msg.toLowerCase().includes("email")),u=s.response.data.details.find(t=>t.param==="password"||t.path==="password"||t.msg&&t.msg.toLowerCase().includes("password"));y?i("email"):u&&i("password");return}if(s.response?.data?.code==="VALIDATION_ERROR"){i(s.response.data.field||null),r(s.response.data.error||s.response.data.message||"Erreur de validation");return}if(!s.response){r(s.message==="Network Error"?"Erreur réseau. Vérifiez votre connexion internet.":"Impossible de joindre le serveur. Vérifiez votre connexion.");return}let n="Échec de connexion. Veuillez réessayer.";s.response?.data?s.response.data.error?n=s.response.data.error:s.response.data.message?n=s.response.data.message:typeof s.response.data=="string"&&(n=s.response.data):s.message&&!s.message.includes("Network Error")&&(n=s.message),r(n)}finally{E(!1)}},B=async o=>{if(o.preventDefault(),d(""),c(""),!j.trim()){d("Veuillez entrer votre adresse email");return}if(!j.includes("@")){d("Veuillez entrer une adresse email valide");return}z(!0);try{c("Un email de réinitialisation a été envoyé à votre adresse email."),p(""),setTimeout(()=>{h(!1),c("")},3e3)}catch(s){console.error("Forgot password error:",s),d(s.response?.data?.error||s.message||"Erreur lors de l'envoi de l'email. Veuillez réessayer.")}finally{z(!1)}};return e.jsxs("div",{className:"min-h-screen flex",children:[e.jsxs("div",{className:"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-blue-600 via-indigo-600 to-purple-700 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=1920&h=1080&fit=crop&q=80')] bg-cover bg-center"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-600/80 via-indigo-600/80 to-purple-700/80"}),e.jsx("div",{className:"absolute inset-0 bg-black/20"}),e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-white/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative w-full flex flex-col items-center justify-center text-white p-12 animate-fade-in z-10",children:[e.jsx("div",{className:"w-28 h-28 bg-white/20 backdrop-blur-xl rounded-3xl flex items-center justify-center mb-8 animate-float shadow-2xl border border-white/30",children:e.jsx(M,{className:"w-14 h-14 text-white drop-shadow-lg"})}),e.jsxs("h2",{className:"text-4xl md:text-5xl font-bold mb-6 text-center drop-shadow-lg",children:["Gestion Immobilière",e.jsx("br",{}),e.jsx("span",{className:"text-blue-200",children:"Simplifiée"})]}),e.jsx("p",{className:"text-lg text-white/90 text-center max-w-md leading-relaxed drop-shadow-md",children:"Votre plateforme complète de gestion immobilière pour la colocation et le partage de logement."}),e.jsxs("div",{className:"mt-12 flex gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-white/10 backdrop-blur-lg rounded-2xl flex items-center justify-center mb-3 border border-white/20",children:e.jsx(U,{className:"w-8 h-8 text-white"})}),e.jsx("p",{className:"text-sm text-white/80",children:"Propriétés"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-white/10 backdrop-blur-lg rounded-2xl flex items-center justify-center mb-3 border border-white/20",children:e.jsx($,{className:"w-8 h-8 text-white"})}),e.jsx("p",{className:"text-sm text-white/80",children:"Locataires"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-white/10 backdrop-blur-lg rounded-2xl flex items-center justify-center mb-3 border border-white/20",children:e.jsx(H,{className:"w-8 h-8 text-white"})}),e.jsx("p",{className:"text-sm text-white/80",children:"Paiements"})]})]})]})]}),e.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-8 bg-gray-50",children:e.jsxs("div",{className:"w-full max-w-md space-y-8 animate-fade-in-up",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"lg:hidden inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-2xl mb-6 animate-float",children:e.jsx(M,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-heading-large mb-3",children:"Bienvenue"}),e.jsx("p",{className:"text-body-medium text-gray-600",children:"Connectez-vous à votre tableau de bord"})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-lg shadow-gray-100/50 p-8 space-y-6 hover:shadow-xl transition-shadow duration-300",children:e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"form-label mb-2",children:"Email"}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 transition-colors duration-200 group-focus-within:text-blue-500",children:e.jsx(G,{className:"w-full h-full"})}),e.jsx("input",{id:"email",type:"email",value:m,onChange:o=>R("email",o.target.value),className:`form-input w-full pl-12 pr-4 py-3 border rounded-xl bg-gray-50 focus:bg-white focus:ring-2 transition-all duration-200 ${w==="email"?"border-red-500 focus:ring-red-200 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-transparent"}`,placeholder:"Entrez votre email",required:!0,disabled:f,"aria-invalid":w==="email"?"true":"false","aria-describedby":"email-error"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"form-label mb-2",children:"Mot de passe"}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 transition-colors duration-200 group-focus-within:text-blue-500",children:e.jsx(J,{className:"w-full h-full"})}),e.jsx("input",{id:"password",type:v?"text":"password",value:x,onChange:o=>I(o.target.value),className:"form-input w-full pl-12 pr-4 py-3 border border-gray-300 rounded-xl bg-gray-50 focus:bg-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Entrez votre mot de passe",required:!0}),e.jsx("button",{type:"button",onClick:()=>q(o=>!o),"aria-label":v?"Masquer le mot de passe":"Afficher le mot de passe",className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:v?e.jsx(W,{className:"w-5 h-5"}):e.jsx(_,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:()=>h(!0),className:"text-sm text-blue-600 hover:text-blue-700 hover:underline transition-colors duration-200",children:"Mot de passe oublié ?"})}),N&&e.jsx("div",{className:"bg-red-50/50 border border-red-100 rounded-xl p-4 backdrop-blur-sm",children:e.jsx("p",{className:"text-red-600 text-body-small",children:N})}),S&&e.jsx("div",{className:"bg-green-50/50 border border-green-100 rounded-xl p-4 backdrop-blur-sm",children:e.jsx("p",{className:"text-green-700 text-body-small",children:S})}),e.jsx("button",{type:"submit",disabled:f,className:"btn-text w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white py-3 px-6 rounded-xl shadow-lg shadow-blue-500/20 hover:shadow-xl hover:shadow-blue-500/30 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Connexion...":"Se connecter"})]})}),e.jsx("div",{className:"text-center mt-8",children:e.jsx("p",{className:"text-body-small text-gray-500",children:"© 2025 HomeShare. Tous droits réservés."})})]})}),D&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-8 space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-heading-medium text-gray-900",children:"Mot de passe oublié"}),e.jsx("button",{onClick:()=>{h(!1),p(""),d(""),c("")},className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Fermer",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("p",{className:"text-body-medium text-gray-600",children:"Entrez votre adresse email et nous vous enverrons un lien pour réinitialiser votre mot de passe."}),e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"forgot-email",className:"form-label mb-2",children:"Email"}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 transition-colors duration-200 group-focus-within:text-blue-500",children:e.jsx(K,{className:"w-full h-full"})}),e.jsx("input",{id:"forgot-email",type:"email",value:j,onChange:o=>p(o.target.value),className:"form-input w-full pl-12 pr-4 py-3 border border-gray-300 rounded-xl bg-gray-50 focus:bg-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Entrez votre email",required:!0,disabled:b})]})]}),P&&e.jsx("div",{className:"bg-red-50/50 border border-red-100 rounded-xl p-4",children:e.jsx("p",{className:"text-red-600 text-body-small",children:P})}),F&&e.jsx("div",{className:"bg-green-50/50 border border-green-100 rounded-xl p-4",children:e.jsx("p",{className:"text-green-700 text-body-small",children:F})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{h(!1),p(""),d(""),c("")},className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 transition-colors duration-200",disabled:b,children:"Annuler"}),e.jsx("button",{type:"submit",disabled:b,className:"flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-xl shadow-lg shadow-blue-500/20 hover:shadow-xl hover:shadow-blue-500/30 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Envoi...":"Envoyer"})]})]})]})})]})};export{re as default};
